# uni-app

## ç®€ä»‹

**uni-app æ˜¯ä¸€ä¸ªä½¿ç”¨ Vue.jsè¿›è¡Œ å¼€å‘æ‰€æœ‰å‰ç«¯åº”ç”¨çš„æ¡†æ¶**ã€‚å¼€å‘è€…ç¼–å†™ä¸€å¥—ä»£ç ï¼Œå³å¯å‘å¸ƒåˆ° iOSã€Androidã€H5ã€ä»¥åŠå„ç§å°ç¨‹åºï¼ˆå¾®ä¿¡/æ”¯ä»˜å®/ç™¾åº¦/å¤´æ¡/QQ/é’‰é’‰/æ·˜å®ï¼‰ã€å¿«åº”ç”¨ç­‰å¤šä¸ªå¹³å°ã€‚


![image-20230210163433478](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302101634632.png)

> è¯¦ç»†çš„ uni-app å®˜æ–¹æ–‡æ¡£ï¼Œè¯·ç¿»é˜… https://uniapp.dcloud.net.cn/



## å­¦ä¹ uniappæœ¬è´¨

1. ç§»åŠ¨ç«¯æŠ€æœ¯å¤ªå¤šï¼Œè·¨ç«¯æ¡†æ¶æˆ–æ˜¯æœªæ¥å‘å±•è¶‹åŠ¿ã€‚
2. ä¸€å¥—ä»£ç å¤šç«¯å‘å¸ƒå—å¼€å‘è€…é’çã€‚
3. å®Œæ•´çš„ç”Ÿæ€ï¼Œå—ä¼ä¸šé’ç

---

## uniappä¼˜åŠ¿

![image-20230210163555719](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302101635823.png)

---

## uni-appå’Œvueçš„å…³ç³»

- ä½¿ç”¨vueJSå¼€å‘
- åœ¨å‘å¸ƒåˆ°H5æ—¶ï¼Œæ”¯æŒæ‰€æœ‰vueè¯­æ³•
- å‘å¸ƒåˆ°Appå’Œå°ç¨‹åºæ—¶ï¼Œå®ç°éƒ¨åˆ†Vueè¯­æ³•

## uni-appå’Œå°ç¨‹åºæœ‰ä»€ä¹ˆå…³ç³»

- ç»„ä»¶æ ‡ç­¾é è¿‘å°ç¨‹åºè§„èŒƒ
- æ¥å£èƒ½åŠ›ï¼ˆJS APIï¼‰é è¿‘å¾®ä¿¡å°ç¨‹åºå¼€å‘
- å®Œæ•´çš„å°ç¨‹åºç”Ÿå‘½å‘¨æœŸ

## uniappä¸webä»£ç ç¼–å†™åŒºåˆ«

![image-20230210163634428](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302101636556.png)

## è¯¾ç¨‹å†…å®¹

## å­¦ä¹ é‡ç‚¹

1. æŒæ¡uniappæŠ€æœ¯æœ¬èº«ï¼Œé€‚é…å…¼å®¹å®‰å“ã€IOSã€html5ã€è…¾è®¯å°ç¨‹åº4ä¸ªå¹³å°
2. æŒæ¡uniappçš„å‰åå°å®Œæ•´å¼€å‘æµç¨‹
3. æŒæ¡ç»„ä»¶åŒ–å¼€å‘æ€è·¯

## çŸ¥è¯†ç‚¹

1. å…¥é—¨å°ç¨‹åº

2. uniappå¼€å‘ç¯å¢ƒæ­å»º

3. uni-appåŸºç¡€apiå­¦ä¹ 

4. unicloudäº‘å¼€å‘å¹³å°å­¦ä¹ 

   1. unicloudåŸºæœ¬ä½¿ç”¨æ–¹æ³•
   2. ç¯å¢ƒé…ç½®
   3. é«˜çº§æ–¹æ³•ä½¿ç”¨

5. å¹³å°é€‚é…

## å®æˆ˜é¡¹ç›®

### é¡¹ç›®æ¼”ç¤º

- h5è®¿é—®åœ°å€ï¼š[[https://uni.duyiedu.com](https://uni.duyiedu.com)]([uni.duyiedu.com](uni.duyiedu.com))
- å®‰å“åº”ç”¨apkä¸‹è½½åœ°å€ï¼š[https://mp-4b2543b2-eec4-4dfa-bbc6-6e1d9847cc1d.cdn.bspapp.com/cloudstorage/__UNI__A49A088__20231122115317.apk](https://mp-4b2543b2-eec4-4dfa-bbc6-6e1d9847cc1d.cdn.bspapp.com/cloudstorage/__UNI__A49A088__20231122115317.apk)
- å¾®ä¿¡å°ç¨‹åºï¼šå°ç¨‹åºå†…æœç´¢ã€Œæ¸¡ä¸€uniappæ¡ˆä¾‹ã€

## é¡¹ç›®ç»“æ„åˆ†æ

### é¦–é¡µé¢

- æœç´¢å¼•å¯¼
  - æœç´¢ç•Œé¢
- å¯¼èˆªæ 
  - å¯¼èˆªåˆ—è¡¨å±•ç¤º
  - å¯¼èˆªæ ‡ç­¾è®¾ç½®
- æ–‡ç« åˆ—è¡¨
  - æ–‡ç« æ”¶è—
  - å›¾æ–‡ä¿¡æ¯å±•ç¤º
- æ–‡ç« è¯¦æƒ…
  - ä½œè€…å…³æ³¨
  - å¯Œæ–‡æœ¬æ¸²æŸ“
  - æ–‡ç« è¯„è®º
    - è¯„è®ºå›å¤
    - æŒ‡å®šè¯„è®ºå›å¤
    - è¯„è®ºå‘å¸ƒ
    - è¯„è®ºç»„ä»¶å±•ç¤º

### å…³æ³¨ç•Œé¢

- æ–‡ç« 
  - æ–‡ç« åˆ—è¡¨å±•ç¤º
- ä½œè€…
  - ä½œè€…åˆ—è¡¨å±•ç¤º

### æˆ‘çš„ç•Œé¢

1. ç™»å½•
   - ä¸ªäººä¿¡æ¯å±•ç¤º
   - æˆ‘çš„æ–‡ç« 
   - æ„è§åé¦ˆ
     - å›¾ç‰‡ä¸Šä¼ 
     - åé¦ˆä¿¡æ¯ä¸Šä¼ 
2. æœªç™»å½•
   - ç™»å½•ä¿¡æ¯æç¤º
   - è·³è½¬ç™»å½•ç•Œé¢

### æ³¨å†Œç™»å½•æ¨¡å—

1. ç™»å½•
   - è´¦å·ç™»å½•
     - è´¦å·å¯†ç å®ç°ç™»å½•åŠŸèƒ½
   - æ‰‹æœºç™»å½•	
     - æ‰‹æœºå·éªŒè¯ç å®ç°ç™»å½•åŠŸèƒ½

### é¡¹ç›®æ•´ä½“æµç¨‹

1. é¡µé¢æ„å»º

2. æ•°æ®å¤„ç†

3. é€»è¾‘å®ç°

4. é€‚é…å‘è¡Œ

   1. å¤šå¹³å°é€‚é…
   2. å¤šå¹³å°æ‰“åŒ…
   3. å¤šå¹³å°å‘å¸ƒï¼ˆå®‰å“ã€IOSã€å°ç¨‹åºã€h5)

   

## è¯¾ç¨‹è®²è§£æ–¹å¼

- é¡¹ç›®ä¸ºå¯¼å‘ï¼Œåªå­¦ä¹ é¡¹ç›®éœ€è¦ç›¸å…³API
- æ¨¡å—ä¸ºæ ¸å¿ƒï¼Œé€æ­¥å®ç°é¡¹ç›®
- cssé‡å¤ä»£ç éƒ¨åˆ†è¿›è¡Œç²˜è´´å¤åˆ¶ï¼Œå…¶ä½™å…¨éƒ¨å®ç°æ‰‹å†™

# å¾®ä¿¡å°ç¨‹åºç®€ä»‹

## æ–‡æ¡£ç›¸å…³

1. å¼€å‘æ–‡æ¡£ï¼šhttps://developers.weixin.qq.com/miniprogram/dev/framework/
2. å¾®ä¿¡å…¬ä¼—å¹³å°ï¼šhttps://mp.weixin.qq.com/

## å¼€å‘è€…å·¥å…·

â€‹	ä¸‹è½½åœ°å€ï¼šhttps://developers.weixin.qq.com/miniprogram/dev/devtools/download.html

### ä½¿ç”¨

**å¿…é€‰é¡¹å¤„ç†**

![image-20230210164011622](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302101640719.png)

**appIDè·å–**

> å¾®ä¿¡å…¬ä¼—å¹³å°è¿›è¡ŒappIDè·å–

![](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302101641411.png)

### å°ç¨‹åºä»£ç æ„æˆ

> å‚è€ƒåœ°å€ï¼šhttps://developers.weixin.qq.com/miniprogram/dev/framework/quickstart/code.html#JSON-%E9%85%8D%E7%BD%AE

1. `.json` åç¼€çš„ `JSON` é…ç½®æ–‡ä»¶
2. `.wxml` åç¼€çš„ `WXML` æ¨¡æ¿æ–‡ä»¶
3. `.wxss` åç¼€çš„ `WXSS` æ ·å¼æ–‡ä»¶
4. `.js` åç¼€çš„ `JS` è„šæœ¬é€»è¾‘æ–‡ä»¶



**å°ç¨‹åºåŸºæœ¬ç»“æ„**

```html
<view class="container">
  <view class="userinfo">
    <button wx:if="{{!hasUserInfo && canIUse}}"> è·å–å¤´åƒæ˜µç§° </button>
    <block wx:else>
      <image src="{{userInfo.avatarUrl}}" background-size="cover"></image>
      <text class="userinfo-nickname">{{userInfo.nickName}}</text>
    </block>
  </view>
  <view class="usermotto">
    <text class="user-motto">{{motto}}</text>
  </view>
</view>
```



### å°ç¨‹åºåŸºæœ¬æ“ä½œ

- **é…ç½®ä¿¡æ¯**

  - å…¨å±€é…ç½® -> https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html

    ```json
    {
      "pages": [
        "pages/index/index",
        "pages/logs/index"
      ],
      "window": {
        "navigationBarTitleText": "Demo"
      },
      "tabBar": {
        "list": [{
          "pagePath": "pages/index/index",
          "text": "é¦–é¡µ"
        }, {
          "pagePath": "pages/logs/index",
          "text": "æ—¥å¿—"
        }]
      },
      "networkTimeout": {
        "request": 10000,
        "downloadFile": 10000
      },
      "debug": true
    }
    ```

    

  - é¡µé¢é…ç½®

    ```json
    {
      "navigationBarBackgroundColor": "#ffffff",
      "navigationBarTextStyle": "black",
      "navigationBarTitleText": "å¾®ä¿¡æ¥å£åŠŸèƒ½æ¼”ç¤º",
      "backgroundColor": "#eeeeee",
      "backgroundTextStyle": "light"
    }
    ```

- **å…¨å±€ç”Ÿå‘½å‘¨æœŸå‡½æ•°**

  ```js
    /**
     * å½“å°ç¨‹åºåˆå§‹åŒ–å®Œæˆæ—¶ï¼Œä¼šè§¦å‘ onLaunchï¼ˆå…¨å±€åªè§¦å‘ä¸€æ¬¡ï¼‰
     */
    onLaunch: function () {
      
    },
  
    /**
     * å½“å°ç¨‹åºå¯åŠ¨ï¼Œæˆ–ä»åå°è¿›å…¥å‰å°æ˜¾ç¤ºï¼Œä¼šè§¦å‘ onShow
     */
    onShow: function (options) {
      
    },
  
    /**
     * å½“å°ç¨‹åºä»å‰å°è¿›å…¥åå°ï¼Œä¼šè§¦å‘ onHide
     */
    onHide: function () {
      
    },
  
    /**
     * å½“å°ç¨‹åºå‘ç”Ÿè„šæœ¬é”™è¯¯ï¼Œæˆ–è€… api è°ƒç”¨å¤±è´¥æ—¶ï¼Œä¼šè§¦å‘ onError å¹¶å¸¦ä¸Šé”™è¯¯ä¿¡æ¯
     */
    onError: function (msg) {
      
    }
  ```

  - **é¡µé¢ç”Ÿå‘½å‘¨æœŸå‡½æ•°** -> https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page-life-cycle.html

  ```js
   onLoad: function(options) {
      // é¡µé¢åˆ›å»ºæ—¶æ‰§è¡Œ
    },
    onShow: function() {
      // é¡µé¢å‡ºç°åœ¨å‰å°æ—¶æ‰§è¡Œ
    },
    onReady: function() {
      // é¡µé¢é¦–æ¬¡æ¸²æŸ“å®Œæ¯•æ—¶æ‰§è¡Œ
    },
    onHide: function() {
      // é¡µé¢ä»å‰å°å˜ä¸ºåå°æ—¶æ‰§è¡Œ
    },
    onUnload: function() {
      // é¡µé¢é”€æ¯æ—¶æ‰§è¡Œ
    },
    onPullDownRefresh: function() {
      // è§¦å‘ä¸‹æ‹‰åˆ·æ–°æ—¶æ‰§è¡Œ
    },
    onReachBottom: function() {
      // é¡µé¢è§¦åº•æ—¶æ‰§è¡Œ
    },
    onShareAppMessage: function () {
      // é¡µé¢è¢«ç”¨æˆ·åˆ†äº«æ—¶æ‰§è¡Œ
    },
    onPageScroll: function() {
      // é¡µé¢æ»šåŠ¨æ—¶æ‰§è¡Œ
    },
    onResize: function() {
      // é¡µé¢å°ºå¯¸å˜åŒ–æ—¶æ‰§è¡Œ
    }
  ```

- **ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ**->https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html

  ```js
  Component({
    lifetimes:{
      created() {
        console.log('created,ç»„ä»¶å®ä¾‹åˆšåˆšè¢«åˆ›å»ºå¥½æ—¶ï¼Œ created ç”Ÿå‘½å‘¨æœŸè¢«è§¦å‘')
      },
      attached() {
        console.log('ç»„ä»¶å®åŠ›è¿›å…¥é¡µé¢èŠ‚ç‚¹æ ‘æ—¶å€™è¿›è¡Œæ‰§è¡Œ');
      },
      detached() {
        console.log('åœ¨ç»„ä»¶å®ä¾‹è¢«ä»é¡µé¢èŠ‚ç‚¹æ ‘ç§»é™¤æ—¶æ‰§è¡Œ');
      }
    }
  })
  ```

  

- **ç•Œé¢è·³è½¬**

  - æ–°ç•Œé¢æ‰“å¼€=>https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/route.html

    ```js
    è°ƒç”¨ API wx.navigateTo
    ä½¿ç”¨ç»„ä»¶ <navigator open-type="navigateTo"/>
    ```

  - é¡µé¢é‡å®šå‘

    ```js
    è°ƒç”¨ API wx.redirectTo
    ä½¿ç”¨ç»„ä»¶ <navigator open-type="redirectTo"/>
    ```

  - é¡µé¢è¿”å›

    ```
    è°ƒç”¨ API wx.navigateBack
    ä½¿ç”¨ç»„ä»¶<navigator open-type="navigateBack">
    ç”¨æˆ·æŒ‰å·¦ä¸Šè§’è¿”å›æŒ‰é’®
    ```

  - Tabåˆ‡æ¢

    ```javascript
    è°ƒç”¨ API wx.switchTab
    ä½¿ç”¨ç»„ä»¶ <navigator open-type="switchTab"/>
    ç”¨æˆ·åˆ‡æ¢ Tab
    ```

  - é‡å¯åŠ¨

    ```js
    è°ƒç”¨ API wx.reLaunch
    ä½¿ç”¨ç»„ä»¶ <navigator open-type="reLaunch"/>
    ```

- **æ•°æ®ç»‘å®š**

  ```html
  <view>{{message}}</view>
  ```

  ```js
  Page({
    data:{
      message:"hello world"
    }
  })
  ```

- **æ¡ä»¶æ¸²æŸ“**

  ```html
  <view wx:if="{{isShow}}">æ¡ä»¶åˆ¤æ–­æ˜¾ç¤º</view>
  ```

  ```
  Page({
  	data:{
  		isShow:false
  	}
  })
  ```

  

- **åˆ—è¡¨æ¸²æŸ“**

  ```html
  <view wx:for="{{list}}" wx:for-index="idx" wx:for-item="itemName">
    {{idx}}: {{itemName.name}}
  </view>
  ```

  ```js
  Page({
    data: {
      list:[
        {name:'a'},
        {name:'b'}
      ]
    }
  })
  ```


# uniappå¼€å‘è§„èŒƒ

- é¡µé¢æ–‡ä»¶éµå¾ªVueå•æ–‡ä»¶ç»„ä»¶ï¼ˆSFCï¼‰è§„èŒƒ

- ç»„ä»¶æ ‡ç­¾é è¿‘å°ç¨‹åºè§„èŒƒ =>https://uniapp.dcloud.io/component/README

  ```vue
  <template>
  	<view>
  		é¡µé¢å†…å®¹
  	</view>
  </template>
  
  <script>
  	export default {
  		data() {
  			return {
  			}
  		},
  		methods: {	
  		}
  	}
  </script>
  
  <style>
  </style>
  ```

- æ¥å£èƒ½åŠ›ï¼ˆJS APIï¼‰é è¿‘å¾®ä¿¡å°ç¨‹åºè§„èŒƒ => https://uniapp.dcloud.io/api/README

  ```java
  uni.getStorageInfoSync()
  ```

- æ•°æ®ç»‘å®šäº‹ä»¶å¤„ç†åŒVue.jsè§„èŒƒ

  ```vue
  <template>
    <view @click="onClickFn">
        ç‚¹å‡»äº‹ä»¶ç»‘å®š
    </view>
  </template>
  
  <script>
  export default {
    methods: {
      onClickFn() {
        console.log('clickäº‹ä»¶')
      }
    }
  }
  </script>
  
  <style lang="scss" scoped>
  </style>
  ```

- å…¼å®¹å¤šç«¯è¿è¡Œï¼Œä½¿ç”¨flexå¸ƒå±€è¿›è¡Œå¼€å‘

## uniappå¼€å‘ç¯å¢ƒ

### å¼€å‘å·¥å…·

uni-app å®˜æ–¹æ¨èä½¿ç”¨ **HBuilderX** æ¥å¼€å‘ uni-app ç±»å‹çš„é¡¹ç›®ã€‚ä¸»è¦å¥½å¤„ï¼š

- æ¨¡æ¿ä¸°å¯Œ
- å®Œå–„çš„æ™ºèƒ½æç¤º
- ä¸€é”®è¿è¡Œ

### ä¸‹è½½ HBuilderX

1. è®¿é—® HBuilderX çš„å®˜ç½‘é¦–é¡µ https://www.dcloud.io/hbuilderx.html
2. ç‚¹å‡»é¦–é¡µçš„ `DOWNLOAD` æŒ‰é’®
3. é€‰æ‹©ä¸‹è½½ `æ­£å¼ç‰ˆ`/alpha -> `App å¼€å‘ç‰ˆ`
4. å°†ä¸‹è½½çš„ `zipåŒ…` è¿›è¡Œè§£å‹ç¼©
5. å°†è§£å‹ä¹‹åçš„æ–‡ä»¶å¤¹ï¼Œå­˜æ”¾åˆ°**çº¯è‹±æ–‡**çš„ç›®å½•ä¸­ï¼ˆä¸”ä¸èƒ½åŒ…å«æ‹¬å·ç­‰ç‰¹æ®Šå­—ç¬¦ï¼‰
6. åŒå‡» `HBuilderX.exe` å³å¯å¯åŠ¨ HBuilderX
7. è¯¦ç»†å®‰è£…æ–‡æ¡£ï¼š=> https://hx.dcloud.net.cn/Tutorial/install/windows

## å·¥ç¨‹æ­å»º

1. æ–‡ä»¶ -> æ–°å»º -> é¡¹ç›®

   ![image-20230210164710394](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302101647480.png)

2. å¡«å†™é¡¹ç›®åŸºæœ¬ä¿¡æ¯

   ![image-20230210164806181](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302101648279.png)

3. é¡¹ç›®åˆ›å»ºæˆåŠŸ

   ![image-20230210170218380](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302101702469.png)



â€‹	**åŸºæœ¬ç›®å½•ç»“æ„**

```css
é¡¹ç›®åç§°
----ã€pagesã€‘    å†…éƒ¨å­˜æ”¾æ‰€æœ‰é¡µé¢
----ã€staticã€‘   å­˜æ”¾æ‰€æœ‰é™æ€èµ„æºï¼Œæ¯”å¦‚å›¾ç‰‡ï¼Œå­—ä½“å›¾æ ‡
----ã€unpackageã€‘å­˜æ”¾æ‰€æœ‰æ‰“åŒ…ç”Ÿæˆåçš„æ–‡ä»¶
----app.vue     åº”ç”¨é…ç½®ï¼Œç”¨æ¥é…ç½®Appå…¨å±€æ ·å¼ä»¥åŠç›‘å¬ åº”ç”¨ç”Ÿå‘½å‘¨æœŸ
----main.js			Vueåˆå§‹åŒ–å…¥å£æ–‡ä»¶
----mainfast.json  é…ç½®åº”ç”¨åç§°ã€appidã€logoã€ç‰ˆæœ¬ç­‰æ‰“åŒ…ä¿¡æ¯
----pages.json    é…ç½®é¡µé¢è·¯ç”±ã€å¯¼èˆªæ¡ã€é€‰é¡¹å¡ç­‰é¡µé¢ç±»ä¿¡æ¯
----uni.scss      ç”¨é€”æ˜¯ä¸ºäº†æ–¹ä¾¿æ•´ä½“æ§åˆ¶åº”ç”¨çš„é£æ ¼ã€‚æ¯”å¦‚æŒ‰é’®é¢œè‰²ã€è¾¹æ¡†é£æ ¼ï¼Œuni.scssæ–‡ä»¶é‡Œé¢„ç½®äº†ä¸€æ‰¹scsså˜é‡é¢„ç½®ã€‚
```



## é¡¹ç›®è¿è¡Œ

### æµè§ˆå™¨è¿è¡Œ

1. ![image-20230210165237132](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302101652271.png)

### å°ç¨‹åºè¿è¡Œ

1. å¡«å†™è‡ªå·±çš„å¾®ä¿¡å°ç¨‹åºçš„ AppIDï¼š

   ![image-20230210165041953](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302101650040.png)

2. åœ¨ HBuilderX ä¸­ï¼Œé…ç½®â€œå¾®ä¿¡å¼€å‘è€…å·¥å…·â€çš„**å®‰è£…è·¯å¾„**ï¼š

   ![image-20230210165545670](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302101655749.png)

3. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ï¼Œé€šè¿‡ `è®¾ç½® -> å®‰å…¨è®¾ç½®` é¢æ¿ï¼Œå¼€å¯â€œå¾®ä¿¡å¼€å‘è€…å·¥å…·â€çš„**æœåŠ¡ç«¯å£**ï¼š

   ![image-20230210165824853](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302101658918.png)

4. åœ¨ HBuilderX ä¸­ï¼Œç‚¹å‡»èœå•æ ä¸­çš„ `è¿è¡Œ -> è¿è¡Œåˆ°å°ç¨‹åºæ¨¡æ‹Ÿå™¨ -> å¾®ä¿¡å¼€å‘è€…å·¥å…·`ï¼Œå°†å½“å‰ uni-app é¡¹ç›®ç¼–è¯‘ä¹‹åï¼Œè‡ªåŠ¨è¿è¡Œåˆ°å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ï¼Œä»è€Œæ–¹ä¾¿æŸ¥çœ‹é¡¹ç›®æ•ˆæœä¸è°ƒè¯•ï¼š

   ![image-20230210170117316](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302101701394.png)

5. åˆæ¬¡è¿è¡ŒæˆåŠŸä¹‹åçš„é¡¹ç›®æ•ˆæœï¼š

   ![image-20230210165342165](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302101653318.png)

### appçœŸæœºè¿è¡Œ

> â€‹	ç¡®ä¿ä½ çš„æ‰‹æœºä¸ç”µè„‘æ˜¯åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ä¸‹é¢

1. æ‰‹æœºå¼€å¯å¼€å‘è€…æ¨¡å¼
2. é€‰æ‹©æ•°æ®ç®¡ç†
3. hbuildeXé€‰æ‹©çœŸæœºè¿è¡Œ
4. ç­‰å¾…åŸºåº§å®‰è£…
5. å®‰è£…å®Œæˆæ‰‹æœºè¿è¡Œé¡¹ç›®

### IOSæ¨¡æ‹Ÿå™¨è¿è¡Œ

1.  Xcodeä¸‹è½½
2.  å®šä¹‰ç‰ˆæœ¬è¿›è¡Œæ¨¡æ‹Ÿå™¨è¿è¡Œ

---

# ç»„ä»¶

æ–‡æ¡£å‚è€ƒåœ°å€ï¼šhttps://uniapp.dcloud.net.cn/component/

## åŸºç¡€ç»„ä»¶

> åŸºç¡€ç»„ä»¶åœ¨uni-appæ¡†æ¶ä¸­å·²ç»å†…ç½®ï¼Œæ— éœ€å°†å†…ç½®ç»„ä»¶çš„æ–‡ä»¶å¯¼å…¥é¡¹ç›®ï¼Œä¹Ÿæ— éœ€æ³¨å†Œå†…ç½®ç»„ä»¶ï¼Œéšæ—¶å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œæ¯”å¦‚`<view>`ç»„ä»¶ã€‚


**ç»„ä»¶æ¼”ç¤ºå‚è€ƒåœ°å€** => https://hellouniapp.dcloud.net.cn/pages/component/view/view

### åŸºç¡€ç»„ä»¶åˆ—è¡¨

- è§†å›¾å®¹å™¨
  - view è§†å›¾å®¹å™¨ï¼Œç±»ä¼¼äºhtmlä¸­çš„div
  - scroll-view å¯æ»šåŠ¨è¯•å›¾å®¹å™¨ => https://uniapp.dcloud.net.cn/component/scroll-view
  - swiper æ»‘å—è§†å›¾å®¹å™¨ï¼Œæ¯”å¦‚ç”¨äºè½®æ’­banner
- åŸºç¡€å†…å®¹
  - icon å›¾æ ‡ => uni-icons
  - text æ–‡å­—
  - rich-text æ–‡å­—
  - progress è¿›åº¦æ¡
- è¡¨å•ç»„ä»¶ï¼ˆFormï¼‰
  - button æŒ‰é’®
  - checkbox å¤šé¡¹é€‰æ‹©å™¨
  - editor å¯Œæ–‡æœ¬è¾“å…¥æ¡†
  - form è¡¨å•
  - input è¾“å…¥æ¡†
  - label æ ‡ç­¾
  - picker å¼¹å‡ºå¼èŠè¡¨é€‰æ‹©å™¨
  - picker-view çª—ä½“å†…åµŒå…¥å¼èŠè¡¨é€‰æ‹©å™¨
  - radio å•é¡¹é€‰æ‹©å™¨
  - slider æ»‘åŠ¨é€‰æ‹©å™¨
  - switch å¼€å…³é€‰æ‹©å™¨
  - textarea å¤šè¡Œæ–‡æœ¬è¾“å…¥æ¡†
- è·¯ç”±ä¸é¡µé¢è·³è½¬ï¼ˆNavigationï¼‰
  - navigator é¡µé¢é“¾æ¥ï¼Œç±»ä¼¼äºhtmlä¸­çš„aæ ‡ç­¾
- åª’ä½“ç»„ä»¶
  - audio éŸ³é¢‘
  - camera ç›¸æœº
  - image å›¾ç‰‡
  - video è§†é¢‘

### ç»„ä»¶å…¬å…±å±æ€§é›†åˆ

![image-20230213102859192](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131029353.png)

> é™¤äº†ä¸Šè¿°å…¬å…±å±æ€§ï¼Œè¿˜æœ‰ä¸€ç±»ç‰¹æ®Šå±æ€§ä»¥`v-`å¼€å¤´ï¼Œç§°ä¹‹ä¸ºvueæŒ‡ä»¤ï¼Œå¦‚v-ifã€v-elseã€v-forã€v-modelã€‚

## æ‰©å±•ç»„ä»¶

Demoåœ°å€ï¼šhttps://hellouniapp.dcloud.net.cn/pages/component/scroll-view/scroll-view

å‚è€ƒåœ°å€ï¼šhttps://ext.dcloud.net.cn/search?q=uni-icons

## è‡ªå®šä¹‰ç»„ä»¶

1. componetsæ–‡ä»¶å¤¹ä¸‹å®šå®šä¹‰ç»„ä»¶
2. é¡µé¢å¼•ç”¨ç»„ä»¶ï¼Œæ— éœ€å€’å…¥é€‚é‡ï¼Œç›´æ¥ä½¿ç”¨å³å¯
3. å…¶ä»–æ“ä½œï¼ˆç»„ä»¶ä¼ å€¼ï¼Œäº‹ä»¶ç»‘å®šåŒvueï¼‰

## åŸºç¡€API

**å‚è€ƒåœ°å€**ï¼šhttps://uniapp.dcloud.net.cn/api/README

### APIåˆ—è¡¨

- **ç½‘ç»œè¯·æ±‚**

  - uni.request å‘èµ·ç½‘ç»œè¯·æ±‚

    > ä¸ºäº†è§£å†³uni.requestç½‘ç»œè¯·æ±‚APIç›¸å¯¹ç®€å•çš„é—®é¢˜ï¼Œå¯ä½¿ç”¨@escook/request-miniprogramè¿›è¡Œç½‘è·¯è¯·æ±‚çš„å¤„ç†
    >
    > å‚è€ƒåœ°å€ï¼šhttps://www.npmjs.com/package/@escook/request-miniprogram
    >
    > **åœ¨å°ç¨‹åºä¸­ï¼Œæ— æ³•ä½¿ç”¨fetchåŠaxiosè¿›è¡Œç½‘ç»œè¯·æ±‚å‘é€**

    **æµ‹è¯•æ¥å£åœ°å€ï¼šhttps://study.duyiedu.com/api/herolist**

- ä¸Šä¼ ã€ä¸‹è½½

  - uni.unloadFile ä¸Šä¼ æ–‡ä»¶  => https://uniapp.dcloud.net.cn/api/request/network-file
  - uni.downloadFile ä¸‹è½½æ–‡ä»¶

- å›¾ç‰‡å¤„ç†

  - uni.chooseImage ä»ç›¸å†Œé€‰æ‹©å›¾ç‰‡ï¼Œæˆ–è€…æ‹ç…§ =>https://uniapp.dcloud.net.cn/api/media/image?id=chooseimage
  - uni.previewImage é¢„è§ˆå›¾ç‰‡
  - uni.getImageInfo è·å–å›¾ç‰‡ä¿¡æ¯

- æ•°æ®ç¼“å­˜ => https://uniapp.dcloud.net.cn/api/storage/storage?id=setstorage

  - uni.getStorage å¼‚æ­¥è·å–æœ¬åœ°æ•°æ®ç¼“å­˜
  - uni.getStorageSync åŒæ­¥è·å–æœ¬åœ°æ•°æ®ç¼“å­˜
  - uni.setStorage å¼‚æ­¥è®¾ç½®æœ¬åœ°æ•°æ®ç¼“å­˜
  - uni.setStorageSync åŒæ­¥è®¾ç½®æœ¬åœ°æ•°æ®ç¼“å­˜
  - uni.removeStorage å¼‚æ­¥åˆ é™¤æœ¬åœ°æ•°æ®ç¼“å­˜
  - uni.reoveStorageSync åŒæ­¥åˆ é™¤æœ¬åœ°æ•°æ®ç¼“å­˜

- äº¤äº’åé¦ˆ => https://uniapp.dcloud.net.cn/api/ui/prompt?id=showtoast

  - uni.showToast æ˜¾ç¤ºæç¤ºæ¡†
  - uni.showLoading æ˜¾ç¤ºåŠ è½½æç¤ºæ¡†
  - uni.hideToast éšè—æç¤ºæ¡†
  - uni.hideLoading éšè—åŠ è½½æç¤ºæ¡†
  - uni.showModal æ˜¾ç¤ºæ¨¡æ€æ¡†
  - uni.showActionSheet æ˜¾ç¤ºèœå•åˆ—è¡¨

- è·¯ç”±

  - uni.navigateTo ä¿ç•™å½“å‰é¡µé¢ï¼Œè·³è½¬åˆ°åº”ç”¨å†…æŸä¸ªç•Œé¢ï¼Œä½¿ç”¨uni.navigateBack è¿”å›åŸé¡µé¢

  - uni.redirectTo å…³é—­å½“å‰ç•Œé¢ï¼Œè·³è½¬åˆ°åº”ç”¨å†…çš„æŸä¸ªç•Œé¢

  - uni.reLaunch å…³é—­æ‰€æœ‰ç•Œé¢ï¼Œæ‰“å¼€åº”ç”¨å†…çš„æŸä¸ªç•Œé¢

  - uni.switchTab è·³è½¬åˆ°tab Baré¡µé¢

    

## é¡µé¢å¸ƒå±€ç›¸å…³

**page**

> é¡µé¢å®¹å™¨csså±æ€§

```css
page:{
  height:100%;
  background-color:red;
}
```

**å°ºå¯¸å•ä½**

å¯ä½¿ç”¨å•ä½ï¼špx rpx,upx, rem vh  vw

**å¤–éƒ¨æ ·å¼æ–‡ä»¶å¼•å…¥**

åŒvueä½¿ç”¨ç›¸åŒ	

## uniappç”Ÿå‘½å‘¨æœŸ

**å‚è€ƒåœ°å€ï¼š**https://uniapp.dcloud.net.cn/collocation/frame/lifecycle?id=%e5%ba%94%e7%94%a8%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f

### åº”ç”¨ç”Ÿå‘½å‘¨æœŸ

- onLaunch åˆå§‹åŒ–å®Œæˆæ—¶è§¦å‘ï¼ˆå…¨å±€ğŸˆ¯ï¸è§¦å‘ä¸€æ¬¡ï¼‰

- onShow uni-appå¯åŠ¨ï¼Œæˆ–ä»åå°è¿›å…¥å‰å°æ˜¾ç¤º

- onHide å½“uni-app åº”ç”¨ä»å‰å°è¿›å…¥åå°

  > åªèƒ½åœ¨App.vueé‡Œé¢è¿›è¡Œç›‘å¬ï¼Œåœ¨å…¶ä»–ç•Œé¢ç›‘å¬æ— æ•ˆ

### é¡µé¢ç”Ÿå‘½å‘¨æœŸ

- onLoad ç›‘å¬é¡µé¢åŠ è½½ï¼ˆå¯è·å–ä¸Šä¸ªç•Œé¢ä¼ é€’çš„å‚æ•°ï¼‰
- onShow ç›‘å¬é¡µé¢æ˜¾ç¤ºï¼Œæ¯æ¬¡å‡ºç°åœ¨å±å¹•ä¸Šéƒ½è¿›è¡Œè§¦å‘
- onReady ç›‘å¬é¡µé¢åˆæ¬¡æ¸²æŸ“å®Œæˆ
- onHide ç›‘å¬é¡µé¢éšè—
- onUnload ç›‘å¬é¡µé¢å¸è½½
- onReachBottom é¡µé¢æ»šåŠ¨åˆ°åº•éƒ¨äº‹ä»¶

### ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ

- beofreCreate 
- created
- boforeMount
- mounted
- boforeDestroy
- destroyed


## uniAppç‰¹è‰²

### æ¡ä»¶ç¼–è¯‘

> æ¡ä»¶ç¼–è¯‘æ˜¯ç”¨ç‰¹æ®Šçš„æ³¨é‡Šä½œä¸ºæ ‡è®°ï¼Œåœ¨ç¼–è¯‘æ—¶æ ¹æ®è¿™äº›ç‰¹æ®Šçš„æ³¨é‡Šï¼Œå°†æ³¨é‡Šé‡Œé¢çš„ä»£ç ç¼–è¯‘åˆ°ä¸åŒå¹³å°ã€‚

**è¯­æ³•**

<img src="https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131037225.png" alt="image-20230213103423907" style="zoom:50%;" />

**æ¡ä»¶ç¼–è¯‘æ”¯æŒçš„æ–‡ä»¶**

- .vue
- .js
- .css
- pages.json
- å„é¢„ç¼–è¯‘è¯­è¨€æ–‡ä»¶ï¼Œå¦‚ï¼š.scssã€.lessã€.stylusã€.tsã€.pug

> â€‹		æ¡ä»¶ç¼–è¯‘æ˜¯åˆ©ç”¨æ³¨é‡Šå®ç°çš„ï¼Œåœ¨ä¸åŒè¯­æ³•é‡Œæ³¨é‡Šå†™æ³•ä¸ä¸€æ ·ï¼Œjsä½¿ç”¨ `// æ³¨é‡Š`ã€css ä½¿ç”¨ `/* æ³¨é‡Š */`ã€vue/nvue æ¨¡æ¿é‡Œä½¿ç”¨ `<!-- æ³¨é‡Š -->`ï¼›

#### æ’ä»¶å®‰è£…

1. â€‹	**scsså®‰è£…**

   > å¯ä»¥ä½¿ç”¨å¤šç§é¢„ç¼–è¯‘å¤„ç†å™¨è¿›è¡Œå®‰è£…ä½¿ç”¨ï¼Œä»¥scssæ–‡ä»¶ä¸ºä¾‹
   >
   > ä¸‹è½½åœ°å€ï¼š**https://ext.dcloud.net.cn/plugin?name=compile-node-sass**


## hbuilderXä¸­ä½¿ç”¨unicloudäº‘å¼€å‘å¹³å°

### æ–‡æ¡£

- å‚è€ƒæ–‡æ¡£ï¼šhttps://uniapp.dcloud.io/uniCloud/README
- webæ§åˆ¶å°æ–‡æ¡£ï¼šhttps://dev.dcloud.net.cn/pages/common/login

### ä¼ ç»Ÿä¸šåŠ¡å¼€å‘æµç¨‹

> â€‹	å‰ç«¯ => åç«¯ => è¿ç»´ => å‘å¸ƒä¸Šçº¿

**ä½¿ç”¨unicloudäº‘å¼€å‘å¹³å°**

> å‰ç«¯ => è¿ç»´ => å‘å¸ƒä¸Šçº¿

### ä»€ä¹ˆæ˜¯unicloud

> `uniCloud` æ˜¯ DCloud è”åˆé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ï¼Œä¸ºå¼€å‘è€…æä¾›çš„åŸºäº serverless æ¨¡å¼å’Œ js ç¼–ç¨‹çš„å®ç°åç«¯æœåŠ¡çš„äº‘å¼€å‘å¹³å°ã€‚ä¸éœ€è¦æœåŠ¡å™¨çš„è´­ä¹°é…ç½®å³å¯å¿«é€Ÿåˆ›å»ºä¸€ä¸ªå®Œæ•´çš„åç«¯æœåŠ¡ã€‚

### unicloudä¼˜ç‚¹

- ç”¨JavaScriptå¼€å‘å‰åå°æ•´ä½“ä¸šåŠ¡
- éh5é¡¹ç›®å…åŸŸåä½¿ç”¨æœåŠ¡å™¨
- æ•æ·æ€§ä¸šåŠ¡å¤„ç†ï¼Œä¸éœ€è¦å‰åç«¯åˆ†ç¦»å¼€å‘

## å¼€å‘æµç¨‹

![image-20230213103914985](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131042219.png)



### uncloudæ„æˆ

![image-20230213104002599](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131042188.png)

#### äº‘æ•°æ®åº“

â€‹	![image-20230213104045259](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131042233.png)



#### äº‘å­˜å‚¨åŠCDN

> å¯è¿›è¡Œæ–‡ä»¶çš„ç›¸å…³å­˜å‚¨æ“ä½œ

å‚è€ƒæ–‡æ¡£ï¼šhttps://uniapp.dcloud.io/uniCloud/storage

#### åˆ›å»ºäº‘å‡½æ•°å·¥ç¨‹

1. **æŒ‡å®šunicloudå·¥ç¨‹åˆ›å»º**

![image-20230213104404149](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131044255.png)

2. **ä¿è¯uni-appåº”ç”¨æ ‡è¯†appIDå¡«å†™**ï¼ˆä¿è¯ç”¨æˆ·ä¸ºç™»å½•çŠ¶æ€ï¼‰

   ![image-20230213104515894](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131045944.png)

3. **è¿›è¡Œäº‘æœåŠ¡ç©ºé—´åˆ›å»º**

   ![image-20230213104434818](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131044921.png)

   > å¦‚æœæœªè¿›è¡Œå®åè®¤è¯ï¼Œä¼šè·³è½¬è‡³å®åè®¤è¯é¡µé¢è¿›è¡Œå®åè®¤è¯ï¼Œç­‰å¾…å®åè®¤è¯å®¡æ ¸ä¹‹åå¯ä»¥å¼€é€šæœåŠ¡ç©ºé—´ã€‚è‹¥è…¾è®¯äº‘å®åè®¤è¯æç¤ºèº«ä»½è¯ä¸‹å·²åˆ›å»ºè¿‡å¤šè´¦æˆ·ï¼Œåˆ™éœ€è¦åœ¨è…¾è®¯äº‘å®˜ç½‘æ³¨é”€ä¸ç”¨çš„è´¦æˆ·

4. è¿›è¡Œäº‘å‡½æ•°åˆ›å»º

   ![image-20230213104602736](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131046847.png)

   ```js
   'use strict';
   // ä¸€ä¸ªé€šè¿‡nodeJSè¿è¡Œçš„å‡½æ•°åœ¨æœåŠ¡å™¨ç«¯ä½¿ç”¨
   exports.main = async (event, context) => {
   	//eventä¸ºå®¢æˆ·ç«¯ä¸Šä¼ çš„å‚æ•°
   	//context åŒ…å«äº†è°ƒç”¨ä¿¡æ¯åŠè¿è¡ŒçŠ¶æ€,è·å–æ¯æ¬¡è°ƒç”¨çš„ä¸Šä¸‹æ–‡
   	console.log('event : ', event)
   	
   	//è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯
   	return {
   		"code":0,
   		"msg":"äº‘å‡½æ•°è°ƒç”¨æˆåŠŸ"
   	}
   };
   ```

   

5. **äº‘WEBæ§åˆ¶å°æŸ¥çœ‹**

   ![image-20230213104631613](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131046690.png)

6. **äº‘æ•°æ®åº“æ“ä½œ**

   > åœ¨äº‘æ•°æ®åº“ä¸­è¿›è¡Œæ•°æ®æ“ä½œï¼Œå…¨éƒ¨ä½¿ç”¨åŒå¼•å·è¿›è¡Œå€¼çš„å®šä¹‰

7. äº‘å­˜å‚¨

   > åœ¨äº‘å­˜å‚¨ä¸­è¿›è¡Œæ–‡ä»¶çš„ä¸Šä¼ 
   >
   > apiä½¿ç”¨ï¼š
   >
   > ```js
   > uniCloud.uploadFile({})
   > ```

8. è·¨åŸŸå¤„ç†

   å‚è€ƒæ–‡æ¡£https://uniapp.dcloud.io/uniCloud/quickstart?id=useinh5

## unicloud apiæ“ä½œ

### äº‘å‡½æ•°è°ƒç”¨

**å‚è€ƒæ–‡æ¡£**ï¼šhttps://uniapp.dcloud.net.cn/uniCloud/cf-functions?id=clientcallfunction

```js
// promiseæ–¹å¼
uniCloud.callFunction({
    name: 'test', // äº‘å‡½æ•°åç§°
    data: { a: 1 }   // è¯·æ±‚å‚æ•°
  })
  .then(res => {});

// callbackæ–¹å¼
uniCloud.callFunction({
    name: 'test',
    data: { a: 1 },
    success(){},  // æˆåŠŸ
    fail(){},   // å¤±è´¥
    complete(){}   // å®Œæˆï¼ˆä¸ç®¡æˆåŠŸä¸å¤±è´¥ï¼‰
});
```

### äº‘å‡½æ•°å®ç°äº‘æ•°æ®åº“åŸºæœ¬å¢åˆ æ”¹æŸ¥

#### 1. è·å–æ•°æ®åº“å¼•ç”¨

```js
const db = uniCloud.database()
```

2. è·å–æ•°æ®åº“é›†åˆå¼•ç”¨

   ```
   const collection = db.collection('unicloud-test-714') // uncloud-test-714 ä¸ºæ•°æ®è¡¨åç§°
   ```

3. æ–°å¢è®°å½•

   ```js
   const res = collection.add({user:'alan'})
   ```

   ```js
   'use strict';
   const db = uniCloud.database() // è·å–æ•°æ®åº“å¼•ç”¨
   
   exports.main = async (event, context) => {
   	// è·å–é›†åˆå¼•ç”¨
   	const collection = db.collection('unicloud-test-714')
   	// æ–°å¢æ•°æ®
   	const res = await collection.add({user:'alan'})
   	console.log(res)
   	return {
   		"code":0,
   		"msg":"äº‘å‡½æ•°è°ƒç”¨æˆåŠŸ"
   	}
   };
   ```

4. åˆ é™¤è®°å½•

   ```js
   	const res = await collection.doc('60ee51103b7d3500014124c1').remove()
   ```

5. æ•°æ®æ›´æ–°

   ```js
   const res = await collection.doc('60ee52a1827eca0001e56bc4').update({
   		name:"joob"
   	})
   
   const res = await collection.doc('60ee52a1827eca0001e56bc4').set({   // å¦‚æœè¯´è·å–ä¸åˆ°å†…å®¹ï¼Œä»æ–°è¿›è¡Œæ’å…¥è®°å½•çš„æ“ä½œ
   		name:"joob",
     	type:"javascript"
   	})
   ```

   > updateä¸setçš„åŒºåˆ«ï¼š
   >
   > å½“æ²¡æœ‰æ‰¾åˆ°æŒ‡å®šè®°å½•æ—¶ï¼Œä½¿ç”¨updateæ— æ³•è¿›è¡Œæ›´æ–°æ“ä½œï¼Œsetåœ¨æ²¡æœ‰æŸ¥æ‰¾åˆ°æŒ‡å®šè®°å½•çš„æ—¶å€™ï¼Œå¯ä»¥è¿›è¡Œæ–°å¢å†…å®¹çš„æ“ä½œï¼ˆä¸å­˜åœ¨è¿›è¡Œåˆ›å»ºæ·»åŠ æ“ä½œï¼‰

6. æ•°æ®æŸ¥æ‰¾

   ```js
   // æŸ¥è¯¢å…¨éƒ¨
   	const res = await collection.get()
   // æŒ‡å®šæ¡ä»¶è¿›è¡ŒæŸ¥è¯¢-idæŸ¥è¯¢
     const res = await collection.doc('id').get()  // idä¸ºéœ€è¦æŸ¥è¯¢çš„æŒ‡å®šid
   // æŒ‡å®šæ¡ä»¶æŸ¥è¯¢-å…¶ä»–æ¡ä»¶è¿›è¡ŒæŸ¥è¯¢
     const res = await collection.where({name:"alan"}).get()
   ```

   #### äº‘å­˜å‚¨æ“ä½œ

   1. ä½¿ç”¨uni.chooseImageæ–¹æ³•è¿›è¡Œå›¾ç‰‡é€‰æ‹©è·å–

      å‚è€ƒåœ°å€ï¼šhttps://uniapp.dcloud.io/api/media/image?id=chooseimage

      ```js
      	uni.chooseImage({
      					count: 1,
      					success(res) {
      						console.log(JSON.stringify(res.tempFilePaths))
      					}
      				})
      ```

   2. ä½¿ç”¨uniCloud.uploadFileè¿›è¡Œæ–‡ä»¶ä¸Šä¼ 

      å‚è€ƒæ–‡æ¡£ï¼šhttps://uniapp.dcloud.io/uniCloud/storage?id=clouduploadfile

      ```js
      uni.chooseImage({
      					count: 1,
      					async success(res) {
      						let result = await uniCloud.uploadFile({
      							filePath:res.tempFilePaths[0],
      							cloudPath:'a.jpg',
      							success(res) {
      								console.log(res)
      							},
      							fail(err) {
      								console.log(err)
      							}
      						});
      					}
      				})
      ```

   3. ä½¿ç”¨uniCloud.deleteFileè¿›è¡Œå›¾ç‰‡åˆ é™¤

      å‚è€ƒæ–‡æ¡£ï¼šhttps://uniapp.dcloud.io/uniCloud/storage?id=clouddeletefile

      **é˜¿é‡Œäº‘å‡½æ•°åˆ é™¤ä¸èƒ½åœ¨å®¢æˆ·ç«¯è¿›è¡Œåˆ é™¤æ“ä½œï¼Œä¸‹åˆ—ä»£ç åœ¨äº‘å‡½æ•°ä¸­è¿›è¡Œä½¿ç”¨**

      ```js
      let result = await uniCloud.deleteFile({
      	   fileList:['https://vkceyugu.cdn.bspapp.com/VKCEYUGU-6ce25980-c28e-4e78-bdef-a96eb40ad98b/06a1cb3a-84b7-47a0-b554-8aff299cb255.jpg'],
      	});
      	console.log(result)
      ```

## é¡¹ç›®å¯åŠ¨-ç»“æ„æ­å»º

### ä¸€ã€åˆå§‹åŒ–æ•°æ®åº“

1. å®šä¹‰ï¼ˆé€‰æ‹©ï¼‰äº‘æœåŠ¡ç©ºé—´

2. åˆå§‹åŒ–æ•°æ®åº“

   1. ä½¿ç”¨db_init.jsonæ–‡ä»¶ 

      å‚è€ƒæ–‡æ¡£ï¼šhttps://uniapp.dcloud.io/uniCloud/hellodb?id=db-init

   2. åˆå§‹åŒ–db_init.jsonæ–‡ä»¶ä½¿ç”¨è¯¾ç¨‹é‡Œé¢æä¾›çš„æ–‡ä»¶å³å¯

      source æ–‡ä»¶å¤¹ => db._init.jsonæ–‡ä»¶

      uniCloudç›®å½•æ‰¾åˆ°databaseç›®å½• æ·»åŠ db_init.jsonæ–‡ä»¶

      ![image-20230213104828561](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131048676.png)

### äºŒã€é™æ€æ–‡ä»¶é…ç½®

#### 1ã€staticæ–‡ä»¶å¯¼å…¥

> â€‹	å¯¼å…¥é¡¹ç›®ä¸­éœ€è¦çš„å›¾ç‰‡æ–‡ä»¶
>
> â€‹	æ–‡ä»¶åœ¨å½“å¤©è¯¾ç¨‹èµ„æ–™sourceæ–‡ä»¶å¤¹ä¸‹è¿›è¡ŒæŸ¥æ‰¾
>
> â€‹	sourceæ–‡ä»¶ç›®å½•ï¼š
>
> - app_logo =>**åº”ç”¨æ‰“åŒ…ç›®å½•**
> - project_img => **å·¥ç¨‹æ‰€éœ€å›¾ç‰‡æ–‡ä»¶**		

#### 2ã€cssé¢„ç¼–è¯‘å¤„ç†å™¨å®šä¹‰

1. uni.scssæ–‡ä»¶å®šä¹‰å…¬å…±å˜é‡åŠæ··ç¼–æ–¹æ³•

2. æ¯ä¸ªé¡µé¢ä¸‹ç›´æ¥è¿›è¡Œæ ·å¼æ–¹æ³•åŠå˜é‡ä½¿ç”¨

   ```scss
   /* å¤šè¡Œæ³¨é‡Š */
   @mixin flex($level_style:space-between, $vertical_style:row, $isWrapper:nowrap) {
       display: flex;
       align-items: center;
       justify-content: $level_style;
       flex-wrap: $isWrapper;
       flex-direction: $vertical_style;
   }
   
   // $base-color:#ff6600;
   /* å…¨å±€ç³»ç»Ÿæ ·å¼å®šä¹‰ */
   $base-color:#f25037;
   ```

   

#### 3ã€page.jsonæ–‡ä»¶-tabBaråˆ›å»º

æ–‡æ¡£å‚è€ƒåœ°å€ï¼šhttps://uniapp.dcloud.net.cn/collocation/pages

> åœ¨ `pages` ç›®å½•ä¸­ï¼Œåˆ›å»ºé¦–é¡µ(home)ã€æˆ‘çš„(self)ã€å…³æ³¨(follow)è¿™ 3 ä¸ª tabBar é¡µé¢ã€‚åœ¨ HBuilderX ä¸­ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹çš„ä¸¤ä¸ªæ­¥éª¤ï¼Œå¿«é€Ÿæ–°å»ºé¡µé¢ï¼š



1. åœ¨ `pages` ç›®å½•ä¸Šé¼ æ ‡å³é”®ï¼Œé€‰æ‹©**æ–°å»ºé¡µé¢**

2. åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œå¡«å†™**é¡µé¢çš„åç§°**ã€**å‹¾é€‰ scss æ¨¡æ¿**ä¹‹åï¼Œç‚¹å‡»åˆ›å»ºæŒ‰é’®ã€‚æˆªå›¾å¦‚ä¸‹ï¼š

   ![image-20230213105800769](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131058829.png)

3. é…ç½®tabBaræ•ˆæœï¼Œä¿®æ”¹é¡¹ç›®æ ¹ç›®å½•ä¸­çš„ `pages.json` é…ç½®æ–‡ä»¶ï¼Œæ–°å¢ `tabBar` çš„é…ç½®èŠ‚ç‚¹å¦‚ä¸‹ï¼š

   ```json
   "tabBar": {
       "color": "#666",
       "selectedColor": "#f25037",
       "backgroundColor": "#fff",
       "list": [   // æ˜¾ç¤ºé¡µé¢ä¿¡æ¯
         {
           "pagePath": "pages/tabBar/index/index",   // é¡µé¢è·¯å¾„
           "iconPath": "static/home.png",   // é»˜è®¤å›¾ç‰‡
           "selectedIconPath": "static/home-active.png",  // é€‰ä¸­å›¾ç‰‡
           "text": "é¦–é¡µ"   // æ–‡å­—æè¿°ä¿¡æ¯
         },
         {
           "pagePath": "pages/tabBar/follow/follow",
           "iconPath": "static/follow.png",
           "selectedIconPath": "static/follow-active.png",
           "text": "å…³æ³¨"
         },
         {
           "pagePath": "pages/tabBar/self/self",
           "iconPath": "static/my.png",
           "selectedIconPath": "static/my-active.png",
           "text": "æˆ‘çš„"
         }
       ]
     }
   ```

4. åˆ é™¤é»˜è®¤indexç•Œé¢

   1. åœ¨ HBuilderX ä¸­ï¼ŒæŠŠ `pages` ç›®å½•ä¸‹çš„ `indexé¦–é¡µæ–‡ä»¶å¤¹` åˆ é™¤æ‰
   2. åŒæ—¶ï¼ŒæŠŠ `page.json` ä¸­è®°å½•çš„ `index é¦–é¡µ` è·¯å¾„åˆ é™¤æ‰

5. ä¿®æ”¹globalStyleæ ·å¼

   ```json
    "globalStyle": {
       "navigationBarTextStyle": "white",
       "navigationBarTitleText": "æ¸¡ä¸€æ•™è‚²",
       "navigationBarBackgroundColor": "#f25037",
       "backgroundColor": "#F8F8F8"
     },
   ```

#### 4ã€é¡µé¢å®šä¹‰

> â€‹	åˆ›å»ºtabBaréœ€è¦çš„é¡µé¢æ–‡ä»¶ 
>
> indexé¡µé¢
>
> followé¡µé¢
>
> selfé¡µé¢

#### 5ã€indexï¼ˆé¦–é¡µï¼‰ç•Œé¢åˆ¶ä½œ

- å¯¼èˆªæ -navBarç»„ä»¶å®ç°

  > åŒåç»„ä»¶åä¸éœ€è¦ä½¿ç”¨import è¿›è¡Œå¯¼å…¥

  ```css
  easyCom components/ç»„ä»¶å/ç»„ä»¶å.vue   // ç‰¹ç‚¹ï¼šå±€éƒ¨å¼•å…¥
  ```

  **å¾®ä¿¡åŠAPPè¿›è¡ŒçŠ¶æ€æ é«˜åº¦è¿›è¡Œå ä½å¤„ç†**

  æ–¹æ³•å‚è€ƒåœ°å€ï¼šhttps://uniapp.dcloud.io/api/system/info?id=getsysteminfosync

  ```js
   // è·å–æ‰‹æœºç³»ç»Ÿä¿¡æ¯
      const info = uni.getSystemInfoSync()
      // è®¾ç½®çŠ¶æ€æ é«˜åº¦
      this.statusBarHeight = info.statusBarHeight
  ```

  **èƒ¶å›Šä¿¡æ¯è·å–**

  æ–‡æ¡£å‚è€ƒåœ°å€ï¼šhttps://uniapp.dcloud.io/api/ui/menuButton?id=getmenubuttonboundingclientrect

  **éœ€è¦è¿›è¡Œæ¡ä»¶ç¼–è¯‘å®ç°**

  ```js
  // (èƒ¶å›Šåº•éƒ¨é«˜åº¦ - çŠ¶æ€æ çš„é«˜åº¦) + (èƒ¶å›Šé¡¶éƒ¨é«˜åº¦ - çŠ¶æ€æ å†…çš„é«˜åº¦) = å¯¼èˆªæ çš„é«˜åº¦
      this.navBarHeight = (menuButtonInfo.bottom - info.statusBarHeight) + (menuButtonInfo.top - info.statusBarHeight)
  ```

  **page.jsonè¿›è¡Œå‰æ™¯è‰²è®¾ç½®**

  ```json
  "navigationBarTextStyle": "white"
  ```

- **tabBarç»„ä»¶å®ç°**

  > é…ç½®tabBaræ•ˆæœï¼Œä¿®æ”¹é¡¹ç›®æ ¹ç›®å½•ä¸­çš„ `pages.json` é…ç½®æ–‡ä»¶ï¼Œæ–°å¢ `tabBar` çš„é…ç½®èŠ‚ç‚¹å¦‚ä¸‹ï¼š

```js
 "globalStyle": {
    "navigationBarTextStyle": "white",
    "navigationBarTitleText": "æ¸¡ä¸€æ•™è‚²",
    "navigationBarBackgroundColor": "#f25037",
    "backgroundColor": "#F8F8F8"
  },
"tabBar": {
    "color": "#666",
    "selectedColor": "#f25037",
    "backgroundColor": "#fff",
    "list": [   // æ˜¾ç¤ºé¡µé¢ä¿¡æ¯
      {
        "pagePath": "pages/index/index",   // é¡µé¢è·¯å¾„
        "iconPath": "static/home.png",   // é»˜è®¤å›¾ç‰‡
        "selectedIconPath": "static/home-active.png",  // é€‰ä¸­å›¾ç‰‡
        "text": "é¦–é¡µ"   // æ–‡å­—æè¿°ä¿¡æ¯
      },
      {
        "pagePath": "pages/follow/follow",
        "iconPath": "static/follow.png",
        "selectedIconPath": "static/follow-active.png",
        "text": "å…³æ³¨"
      },
      {
        "pagePath": "pages/self/self",
        "iconPath": "static/my.png",
        "selectedIconPath": "static/my-active.png",
        "text": "æˆ‘çš„"
      }
    ]
  }
```

## å¯¼èˆªæ åˆ¶ä½œé€‚é…å¤šç«¯

### ä¸€ã€å¯¼èˆªæ ç»„ä»¶åˆ›å»º

1. å®šä¹‰å¯¼èˆªæ ç»„ä»¶

2. å¼•å…¥å¯¼èˆªæ ç»„ä»¶

   ![image-20230213105942614](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131059734.png)


> åŒåç»„ä»¶æ”¯æŒeasycommentï¼Œä¸éœ€è¦ä½¿ç”¨importæ–¹å¼è¿›è¡Œå¯¼å…¥å³å¯ä½¿ç”¨

3. ç»“æ„æ­å»º

   1. å›¾æ ‡ä½¿ç”¨

      uni-iconså›¾æ ‡æ’ä»¶å®‰è£…ï¼š[https://ext.dcloud.net.cn/plugin?id=28](https://ext.dcloud.net.cn/plugin?id=28)

4. å¤„ç†å°ç¨‹åºæ˜¾ç¤ºé”™ä½é—®é¢˜

   **å¾®ä¿¡åŠAPPåº”ç”¨å®ç°çŠ¶æ€æ é«˜åº¦å ä½å¤„ç†**

   æ–¹æ³•å‚è€ƒåœ°å€ï¼š[https://uniapp.dcloud.io/api/system/info?id=getsysteminfosync](https://uniapp.dcloud.io/api/system/info?id=getsysteminfosync)

   ![image-20230213110250401](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131102450.png)

   **å¾®ä¿¡å°ç¨‹åºèƒ¶å›Šä¿¡æ¯è·å–**

   æ–‡æ¡£å‚è€ƒåœ°å€:[https://uniapp.dcloud.io/api/ui/menuButton?id=getmenubuttonboundingclientrect](https://uniapp.dcloud.io/api/ui/menuButton?id=getmenubuttonboundingclientrect)

   ![image-20230213110201536](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131102606.png)

## é€‰é¡¹å¡åˆ¶ä½œ

![image-20230213111015648](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131110721.png)

### ä¸€ ã€ç»„ä»¶åˆ›å»º

> 1. å®šä¹‰ç»„ä»¶tabBar
> 2. indexç•Œé¢é¦–é¡µé¢è¿›è¡Œç»„å»ºå¼•å…¥

### äºŒã€scroll-viewç»„ä»¶ä½¿ç”¨

å‚è€ƒæ–‡æ¡£åœ°å€ï¼šhttps://uniapp.dcloud.io/component/scroll-view

> ä½¿ç”¨scroll-viewæ¨ªå‘æ»šåŠ¨çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„ï¼Œå†…éƒ¨éœ€æ·»åŠ ä¸€ä¸ªå®¹å™¨å¯¹é‡Œé¢çš„æ»šåŠ¨å†…å®¹è¿›è¡ŒåŒ…è£¹

```vue
 <scroll-view class="tab-scroll" scroll-x="true">
      <view class="tab-scroll-box">
        <view v-for="(item, index) in navList" :key="index" class="tab-scroll-item">{{ item }}</view>
      </view>
 </scroll-view>
```

### ä¸‰ã€ç‚¹å‡»è®¾ç½®æŒ‰é’®è·³è½¬åˆ°æ ‡ç­¾è®¾ç½®ç•Œé¢

```vue
 <view class="tab-icons">
      <uni-icons @click="goLabelAdmin" type="gear" size="26" color="#666"></uni-icons>
    </view>

<script>
  // åˆ›å»ºlabelAdminç•Œé¢ä¹‹åè¿›è¡Œè·³è½¬
  uni.navitageTo({url:'/pages/labelAdmin/labelAdmin'})
</script>
```

### å››ã€æ•°æ®è·å–

1. åœ¨pageç•Œé¢onLoadç”Ÿå‘½å‘¨æœŸå†…è¿›è¡Œ_initLableListæ–¹æ³•åˆ›å»º

2. å®šä¹‰äº‘å‡½æ•°ï¼Œè·å–labelè¡¨ä¸­çš„æ•°æ®

   ```js
   'use strict';
   const db = uniCloud.database()
   exports.main = async (event, context) => {
   	const collection = db.collection('label')
   	const res = await collection.get()
   	
   	//è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯
   	return {
   		code:0,
   		labelList:res.data
   	}
   };
   ```

3. pageä¸‹çš„indexç•Œé¢è¿›è¡Œæ•°æ®è·å–ï¼Œå¹¶å°†æ•°æ®ä¼ é€’åˆ°tabBarç»„ä»¶ï¼Œunicloud.callFunctionæ–¹æ³•è¿›è¡Œæ•°æ®è·å–

   ```json
   uniCloud.callFunction({
       name: "get_label_list",
       success:(res)=> {
      	 this.labelList = res.result.labelList
       }
   })
   ```

4. tabBarç»„ä»¶å†…éƒ¨propå±æ€§è¿›è¡Œæ•°æ®è·å–

   ```vue
   props: {
   			labelList: Array
   		}
   ```

## è¯·æ±‚æ–¹æ³•å°è£…

> ä¸ºäº†å‡å°‘ä»£ç çš„å†—ä½™ï¼Œä¼˜åŒ–ä»£ç çš„å¯è¯»æ€§ï¼ŒåŠå¯ç»´æŠ¤æ€§ï¼Œè¿›è¡Œè¯·æ±‚æ–¹æ³•çš„å°è£…

### å®ç°æµç¨‹

#### ä¸€ã€å®šä¹‰å…¬å…±çš„httpè¯·æ±‚æ–¹æ³•

1. åˆ›å»ºhttp.jsæ–‡ä»¶ï¼Œå¯¼å‡ºä¸€ä¸ªå°è£…å¥½çš„promiseå¯¹è±¡ï¼ˆå†…éƒ¨è¿›è¡ŒuniCloudè°ƒç”¨)

   ```js
   export default ({name,data={}})=> {
   	/* å¯¼å‡ºpormiseå¯¹è±¡ */
   	return new Promise((resolve,reject) => {
   		uni.showLoading({
   		})
   		uniCloud.callFunction({
   			name,
   			success({result}) {
   				if(result.code === 0) {
   					resolve(result.data)
   				}else {
   					uni.showToast({icon:"none",title:result.msg})
   				}
   			},
   			fail(err) {
   				reject(err)
   			},
   			complete() {
   				uni.hideLoading()
   			}
   		})
   	})
   }
   ```

#### äºŒã€åˆ›å»ºæ¥å£æ–‡ä»¶è¿›è¡Œå…¬å…±æ–¹æ³•çš„è°ƒç”¨

![image-20230213114708707](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131147814.png)

#### ä¸‰ã€æ–¹æ³•æŒ‚è½½åˆ°VueåŸå‹ä¸Šï¼Œä¾›æ¯ä¸ªç•Œé¢è¿›è¡Œä½¿ç”¨ 

1. **ä½¿ç”¨webpacckçš„require.contextæ–¹æ³•å¯¹æ‰€æœ‰çš„è¯·æ±‚å‡½æ•°æ”¶é›†**

   > require.contextæ˜¯ä»€ä¹ˆï¼Ÿ
   >
   > ä¸€ä¸ªwebpackçš„api,é€šè¿‡æ‰§è¡Œrequire.contextå‡½æ•°è·å–ä¸€ä¸ªç‰¹å®šçš„ä¸Šä¸‹æ–‡,ä¸»è¦ç”¨æ¥å®ç°è‡ªåŠ¨åŒ–å¯¼å…¥æ¨¡å—,åœ¨å‰ç«¯å·¥ç¨‹ä¸­,å¦‚æœé‡åˆ°ä»ä¸€ä¸ªæ–‡ä»¶å¤¹å¼•å…¥å¾ˆå¤šæ¨¡å—çš„æƒ…å†µ,å¯ä»¥ä½¿ç”¨è¿™ä¸ªapi,å®ƒä¼šéå†æ–‡ä»¶å¤¹ä¸­çš„æŒ‡å®šæ–‡ä»¶,ç„¶åè‡ªåŠ¨å¯¼å…¥,ä½¿å¾—ä¸éœ€è¦æ¯æ¬¡æ˜¾å¼çš„è°ƒç”¨importå¯¼å…¥æ¨¡å—

   ```js
   /* æ‰¹é‡è¿›è¡Œæ–‡ä»¶å¯¼å‡º */
   // . =>APIç›®å½•çš„ç›¸å¯¹è·¯å¾„
   // true => æ˜¯å¦æŸ¥è¯¢å­ç›®å½•
   // /.js/ => éœ€è¦æŸ¥è¯¢çš„æ–‡ä»¶çš„åç¼€å
   
   const requireApi = require.context('.', true, /.js$/);
   console.log(requireApi.keys())
   let module = {};
   
   requireApi.keys().forEach((key, index) => {
   	if (key === './index.js') return
   	Object.assign(module, requireApi(key))
   })
   
   export default module
   ```

2. **main.jsè¿›è¡Œæ–¹æ³•æŒ‚è½½**

   ```react
   import module from './ajax/api/index.js'
   Vue.prototype.$http = module;
   ```

   

#### å››ã€é¡µé¢/ç»„ä»¶å†…éƒ¨è¿›è¡Œæ–¹æ³•çš„è°ƒç”¨

```js
async _intiLabelList() {
				const labelList = await this.$http.get_label_list()
				this.labelList = labelList
			}
```



## æ–‡ç« åˆ—è¡¨åˆ¶ä½œ-å®¹å™¨ç»„ä»¶

#### ä¸€ã€å®šä¹‰articleListç»„ä»¶

1. **ä½¿ç”¨swiperç»„ä»¶å®ç°æ»šåŠ¨æ•ˆæœ** https://uniapp.dcloud.io/component/swiper

   1. swiperItemæ•°é‡åŠ¨æ€è¯ï¼Œå½“å‰çš„swiperæ•°é‡åº”è¯¥ä¸é€‰é¡¹å¡çš„æ•°é‡ç›¸åŒ

      è·å–é€‰é¡¹å¡çš„æ•°é‡å€¼ï¼Œæ ¹æ®é€‰é¡¹å¡æ•°é‡è¿›è¡ŒswiperItemæ¸²æŸ“,indexç•Œé¢è¿›è¡ŒlabelListä¼ é€’

      ```react
      		<ArticleList :labelList="labelLIst" class="list-container"></ArticleList>
      ```

   2. ArticleListå†…æ ¹æ®swiperæ•°é‡è¿›è¡ŒswiperItemæ¸²æŸ“

      ```react
       <swiper class="swiper-container">
          <swiper-item v-for="(item,index) in labelList" :key="index">
            <view class="swiper-item uni-bg-red">
              <list-item></list-item>
            </view>
          </swiper-item>
        </swiper>
      ```

      

2. **é€‰é¡¹å¡ä¸swiperç»„ä»¶è”åŠ¨æ•ˆæœå®ç°**

   1. é€‰é¡¹å¡ç‚¹å‡»äº‹ä»¶ç»‘å®š

      å‘é€äº‹ä»¶ï¼Œè°ƒæ•´activeIndexå€¼ï¼Œå°†activeIdnexå€¼è°ƒæ•´ä¸ºçˆ¶ç»„ä»¶ä¼ é€’å€¼

      swiperåˆ¶å®šcurrentå±æ€§ï¼Œå€¼ä¸ºactiveIndex

   2. swiper changeäº‹ä»¶ç›‘å¬ï¼Œå®ç°æ”¹å˜activeIndexå±æ€§

      ```react
       <swiper class="swiper-container" :current="activeIndex" @change="changCurrentIndex">
          <swiper-item v-for="(item,index) in labelList" :key="index">
            <view class="swiper-item uni-bg-red">
              <list-item></list-item>
            </view>
          </swiper-item>
        </swiper>
        
      <script>
        	 methods:{
            changeCurrentIndex(e) {
                const {current}  = e.detail;
                this.$emit('changeCurrentIndex',current)
           	 }
        		}
      </script>
      ```

      

#### äºŒã€é€‰é¡¹å¡è‡ªåŠ¨è¿›è¡Œä½ç½®è°ƒæ•´

1. scroll-view ç»„ä»¶æ·»åŠ å±æ€§ scroll-with-animationåŠ scroll-left å±æ€§  https://uniapp.dcloud.io/component/scroll-view

2. åŠ¨æ€è®¾ç½®scrollintoviewå±æ€§ï¼Œä¸ºæ¯ä¸€é¡¹æ·»åŠ IDå±æ€§è¿›è¡Œè·³è½¬åˆ‡æ¢

   ```react
    <scroll-view class="tab-scroll" scroll-x="true" :scroll-into-view="currentIndex" :scroll-with-animation="true">
         <view class="tab-scroll-box">
           <view :id="`item${index}`" @click="navClickFn(index)" :class="{active:activeIndex === index}" v-for="(item, index) in labelList" :key="index" class="tab-scroll-item">{{ item.name}}</view>
         </view>
       </scroll-view>
   
   <script>
      watch:{
   	  activeIndex(index){
   		this.currentIndex = `item${index}`
   	  }
     },
     data() {
       return {
   		currentIndex:''
       }
     }
   </script>
   ```

3. é€šè¿‡watchå±æ€§ç›‘å¬currIndexå€¼æ”¹å˜ï¼Œè¿›è¡ŒcurrentIndexè®¾å®š

## æ–‡ç« åˆ—è¡¨åˆ¶ä½œ-æ–‡ç« å¡ç‰‡

#### ä¸€ã€åˆ›å»ºæ–‡ç« ç›¸å…³listItemç»„ä»¶

> â€‹	ä½¿ç”¨scroll-view å®ç°ç«–å‘æ»šåŠ¨å®¹å™¨åˆ¶ä½œï¼Œæ³¨æ„åœ¨æ ·å¼å®šä¹‰æ—¶è¿›è¡Œå¤šçº§é«˜åº¦è®¾å®š

```vue
<view class="list-scroll-container">
		<scroll-view scroll-y="true" class="list-scroll">
			<view>
				<ListCard v-for="item in 50" :key="item"></ListCard>
			</view>
		</scroll-view>
</view>
```

#### äºŒã€æ–‡ç« å¡ç‰‡ç»„ä»¶å®šä¹‰

1. åˆ›å»ºåŸºæœ¬æ ·å¼åŠç»“æ„

2. å®šä¹‰å¤šçŠ¶æ€å¡ç‰‡æ¨¡å—

   1. é€šè¿‡çˆ¶ç»„ä»¶ä¼ é€’modeå±æ€§è¿›è¡Œæ¡ä»¶ç¼–è¯‘

   2. æ ¹æ®æ¡ä»¶è¿›è¡Œé€‰é¡¹å¡å¡ç‰‡å±•ç¤º


#### ä¸‰ã€å®šä¹‰uniappæ¨¡ç‰ˆ

1. æ ¹ç›®å½•ä¸‹åˆ›å»ºindex.htmlæ–‡ä»¶
2. å‚è€ƒåœ°å€ï¼šhttps://uniapp.dcloud.io/collocation/manifest?id=h5-template
3. manifestæ–‡ä»¶çš„html5é…ç½®ä¸­è¿›è¡Œindex.htmlæ–‡ä»¶å¼•å…¥

## æ–‡ç« åˆ—è¡¨åˆ¶ä½œ-æ•°æ®æ¸²æŸ“

#### ä¸€ã€äº‘å‡½æ•°åˆ›å»º

> â€‹	å®šä¹‰articleListäº‘å‡½æ•°
>
> åˆ é™¤ä¸éœ€è¦è¿”å›çš„æ–‡ç« è¯¦æƒ…å†…å®¹

```react
'use strict';
const db = uniCloud.database()
exports.main = async (event, context) => {
	const list = await db.collection('article')
	.aggregate()
	.project({
		content:0
	})
	.end()
	//è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯
	return {
		code:0,
		msg:"æ•°æ®è¯·æ±‚æˆåŠŸ",
		data:list.data
	}
};

```

#### äºŒã€å‰ç«¯è¿›è¡Œæ•°æ®è·å–

1. articleListç»„ä»¶ => createdé’©å­ä¸­è¿›è¡Œæ•°æ®è·å–

   ```react
   created () {
       this._getArticleList()
     }
    methods: {
       async _getArticleList () {
         const articleList = await this.$http.get_article_list()
         this.articleList = articleList
       }
     }
   ```

#### ä¸‰ã€æ•°æ®æ¸²æŸ“

listItemç»„ä»¶ä¸­è¿›è¡Œå¾ªç¯æ¸²æŸ“ä½¿ç”¨

```react
<view class="list-scroll-container">
		<scroll-view scroll-y="true" class="list-scroll">
			<view>
				<ListCard :item="item" v-for="(item,index) in articleList" :key="index"></ListCard>
			</view>
		</scroll-view>
	</view>
```



#### å››ã€æ ¹æ®é€‰é¡¹å¡åˆ†ç±»è¿›è¡Œæ•°æ®æ¸²æŸ“

1. æ·»åŠ å…¨éƒ¨åˆ†ç±»é€‰é¡¹

   ```react
   async _intiLabelList() {
   				const labelList = await this.$http.get_label_list()
   				this.labelList = [{name:"å…¨éƒ¨"},...labelList]
   			}
   ```

2. è¯·æ±‚articleListæ—¶è¿›è¡Œæ•°æ®ä¼ é€’ 

   1. ä¸ºäº†ä¿è¯å¯¼èˆªæ•°æ®çš„æ­£ç¡®è·å–ï¼Œè°ƒæ•´createdå‡½æ•°çš„_getArticle_listæ–¹æ³•åœ¨watchä¸­è¿›è¡Œè°ƒç”¨

      ```react
       watch: {
          labelList(newVal,OldVal) {
          this._getArticleList()
          },
        },
      ```

      

3. äº‘å‡½æ•°è¿›è¡Œæ•°æ®è¿‡æ»¤è°ƒæ•´

   ```js
   'use strict';
   const db = uniCloud.database()
   exports.main = async (event, context) => {
   	
   	const {classify} = event
   	
   	let matchObj = {}
   	
   	if(classify !== 'å…¨éƒ¨') {
   		matchObj = {classify}
   	}
   	
   	const list = await db.collection('article')
   	.aggregate()   // ä½¿ç”¨èšåˆçš„å½¢å¼è¿›è¡Œæ•°æ®çš„è·å–
   	.match(matchObj)   // æ ¹æ®åŒ¹é…æ¡ä»¶è¿›è¡Œæ•°æ®è¿”å›
   	.project({
   		content:0    // æœ¬æ¬¡æŸ¥è¯¢ä¸éœ€è¦è¿”å›æ–‡ç« è¯¦æƒ…ç»™å‰ç«¯
   	})
   	.end()
   	//è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯
   	return {
   		code:0,
   		msg:"æ•°æ®è¯·æ±‚æˆåŠŸ",
   		data:list.data
   	}
   };
   
   ```

4. å‰ç«¯å¯¹æ•°æ®è¿›è¡Œç¼“å­˜å¤„ç†

   å°†åŸæœ‰æ¥å—å†…å®¹æ•°ç»„è½¬æ¢ä¸ºå¯¹è±¡è¿›è¡Œå­˜å‚¨ã€‚æ¯æ¬¡changeæ”¹å˜å†…å®¹æ—¶è¿›è¡Œåˆ¤æ–­æ“ä½œå¤„ç†

   ä½¿ç”¨$setæ–¹æ³•è¿›è¡Œå¯¹è±¡çš„é¡µé¢é‡æ–°æ¸²æŸ“

   ```js
   async _getArticleList (currentIndex) {
         const articleList = await this.$http.get_article_list({classify:this.labelList[currentIndex].name})
         this.$set(this.articleData,currentIndex,articleList)
       }
   ```




## æ–‡ç« åˆ—è¡¨åˆ¶ä½œ-ä¸Šæ‹‰åŠ è½½æ›´å¤š



#### ä¸€ã€ä½¿ç”¨uni-load-moreæ’ä»¶

ä¸‹è½½åœ°å€ï¼šhttps://ext.dcloud.net.cn/plugin?id=29

ä½¿ç”¨ï¼š

```react
<uni-load-more status="loading"></uni-load-more>
```

#### äºŒã€ä¿®æ”¹å‚æ•°ä¼ é€’

1. å‰ç«¯æ·»åŠ pageåŠsizeå±æ€§åˆ°äº‘å‡½æ•°

2. äº‘å‡½æ•°å†…è¿›è¡Œè¿”å›å€¼é™åˆ¶å¤„ç†

   ```js
   const list = await db.collection('article')
   		.aggregate() // ä½¿ç”¨èšåˆçš„å½¢å¼è¿›è¡Œæ•°æ®çš„è·å–
   		.match(matchObj) // æ ¹æ®åŒ¹é…æ¡ä»¶è¿›è¡Œæ•°æ®è¿”å›
   		.project({
   			content: 0 // æœ¬æ¬¡æŸ¥è¯¢ä¸éœ€è¦è¿”å›æ–‡ç« è¯¦æƒ…ç»™å‰ç«¯
   		})
   		.skip(pageSize * (page - 1)) // é¦–é¡µä»0å¼€å§‹è®¡ç®—
   		.limit(pageSize) // æ¯é¡µæœ€å¤šè¿”å›å¤šå°‘æ¡æ•°æ®
   		.end()
   ```

3. ç›‘å¬scroll-viewçš„scrolltoloweräº‹ä»¶ï¼Œè§¦åº•æ—¶è¿›è¡Œæ–°çš„æ•°æ®è¯·æ±‚ï¼Œå½“å‰çš„pageå€¼

4. å‰ç«¯è°ƒæ•´æ•°æ®å¤„ç†å°†ç›´æ¥èµ‹å€¼å˜ä¸ºè¿½åŠ æ•°æ®

   ```js
    // å¡«å……æ•°æ®æ—¶æ”¹å˜ä¸ºè¿½åŠ æ•°æ®
         let oldList = this.articleData[currentIndex] || []
         oldList.push(...articleList)
         this.$set(this.articleData, currentIndex, oldList)
   ```


#### ä¸‰ã€åˆ†ç±»é¡µæ•°å¤„ç†

1. åˆ›å»ºæ¯ä¸€ä¸ªåˆ†ç±»çš„å­˜å‚¨å¯¹è±¡ï¼Œå«pageåŠåŠ è½½çŠ¶æ€

   ```js
   loadData:{
   	page:1,
   	loading:loading
   }
   ```

2. å¤„ç†æ•°æ®å…¨éƒ¨åŠ è½½å®ŒæˆçŠ¶æ€

   ```react
   // åˆ¤æ–­å½“å‰åç«¯æ²¡æœ‰è¿”å›æ•°æ®å¤„ç† 
         if(!articleList.length) {
           this.loadData[currentIndex] = {
             loading:"noMore",
             page:this.loadData[currentIndex].page
           }
           this.$forceUpdate()
           return 
         }
   ```


## ç”¨æˆ·ç™»å½•-ç™»å½•ç•Œé¢æ­å»º

#### ä¸€ã€ç»“æ„æ ·å¼ä»£ç ç¼–å†™

1. uni-formsæ’ä»¶ä¸‹è½½

   **ä¸‹è½½åœ°å€**ï¼šhttps://ext.dcloud.net.cn/plugin?id=2773

2. send-codeç»„ä»¶å°è£…

   1. ç»“æ„å¤„ç†

      ```js
      <template>
        <view class="code-container">
          <view class="vCode-btn" @click="getForm">
            {{runTime? `${time}ç§’åé‡æ–°è·å–`:'è·å–éªŒè¯ç '}}
          </view>
        </view>
      </template>
      ```

   2. å®šæ—¶å™¨åˆ›å»º

   3. ç»„ä»¶é”€æ¯æ—¶ï¼Œè¿›è¡Œå‰¯ä½œç”¨ï¼ˆå®šæ—¶å™¨ï¼‰æ¸…é™¤æ“ä½œ

      ```js
      // ç¦»å¼€ç•Œé¢æ—¶è¿›è¡Œå®šæ—¶å™¨çš„æ¸…é™¤æ“ä½œ
        beforeDestroy () {
          clearInterval(this.timeId)
          this.timeId = null
          this.runTime = false
          this.time = 60
        },
      ```




   ## ç”¨æˆ·ç™»å½•-è¡¨å•éªŒè¯

   

   #### ä¸€ã€userRulesMixinæ–‡ä»¶ä½¿ç”¨

   1. commonæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºuserRulesMixin

   ```react
   export default {
     install (Vue) {   // ä½¿ç”¨installçš„å½¢å¼è¿›è¡Œå®‰è£…mixin
       Vue.mixin({
         data () {
           return {
             a:'hello world'
           }
         },
         methods: {
           test () {
   
           }
         }
       })
     }
   }
   ```

   2. main.jsä¸­ä½¿ç”¨mixinæ–‡ä»¶

      ```react
      import userMixin from './common/rulesMixin.js'
      Vue.use(userMixin)
      ```

   3. ç»„ä»¶æˆ–é¡µé¢å†…ç›´æ¥è¿›è¡Œä½¿ç”¨

      ```react
        onLoad: function () {
          console.log(this.test())
        }
      ```

   #### äºŒã€éªŒè¯è§„åˆ™ç¼–å†™

   ```react
     userRules: {
               loginName: {
                 rules: [
                   { required: true, 'errorMessage': "è´¦æˆ·åä¸èƒ½ä¸ºç©º" },
                   {
                     validateFunction: (rule, val, data, callback) => {
                       switch (true) {
                         case val.length < 6:
                           callback('ç”¨æˆ·åé•¿åº¦ä¸æ­£ç¡®')
                           break;
                         default:
                           return true
                       }
                     }
                   }   // è‡ªå®šä¹‰éªŒè¯è§„åˆ™
                 ]
               }
             }
   ```

   

   **æ‰‹æœºå·ç æ­£åˆ™è¡¨è¾¾å¼**

   ```css
   /^(0|86|17951)?(13[0-9]|15[012356789]|166|17[3678]|18[0-9]|14[57])[0-9]{8}$/
   ```

   

   ## ç”¨æˆ·ç™»å½•-è´¦æˆ·åå¯†ç ç™»å½•

   

   #### ä¸€ã€å‰ç«¯æ•°æ®æ•´ç†

   1. å®šä¹‰å‘é€å‡½æ•°ï¼Œå°†ç”¨æˆ·ä¿¡æ¯ä»¥åŠæœ¬æ¬¡è¯·æ±‚çš„ç”¨æˆ·ç™»å½•ç±»å‹ä¼ é€’ç»™åç«¯

      ```react
        this._sendUserInfo({ ...res, type: this.type })
      ```

   2. åˆ›å»ºè¯·æ±‚æ–¹æ³• user_login

   3. å®šä¹‰user_loginå‡½æ•°

      ```react
      'use strict';
      // è·å–æ•°æ®åº“å¼•ç”¨
      const db = uniCloud.database()
      exports.main = async (event, context) => {
        const { loginName, password, phone, type } = event;
      	
        const { affectedDocs, data } = await db.collection('user')
          .aggregate()
          .match(type === 'account' ? { loginName, password } : { phone })
          .end()
      	
        //è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯
        return affectedDocs ? {
          code: 0,
          msg: "è·å–ç”¨æˆ·ä¿¡æ¯æˆåŠŸ",
          data: data[0]
        } : {
          code: 1,
          msg: type === 'account' ? 'è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç”¨æˆ·åæˆ–å¯†ç ' : 'éªŒè¯ç æˆ–æ‰‹æœºå·ç é”™è¯¯'
        }
      };
      
      ```

   4. å‰ç«¯æ¥æ”¶è¿”å›ä¿¡æ¯ï¼Œè¿›è¡Œæ•°æ®å¤„ç†

      1. è·³è½¬ç•Œé¢åˆ°ä¸Šä¸€ä¸ªå†å²è®°å½•
      2. å­˜å‚¨ç”¨æˆ·ä¿¡æ¯

   #### äºŒã€ä½¿ç”¨storeè¿›è¡Œç”¨æˆ·ä¿¡æ¯å­˜å‚¨

   1. åˆ›å»ºå®ä¾‹åŒ–Storeå¯¹è±¡	

      ```react
      import Vue from 'vue'
      import VueX from 'vuex'
      import state from './state.js'
      import mutations from './mutations.js'
      import actions from './actions.js'
      
      
      Vue.use(VueX)
      
      export default new VueX.Store({
        state,
        actions,
        mutations
      })
      ```

   2. main.jsä¸­è¿›è¡Œstoreæ³¨å†Œ

   3. è·å–ç”¨æˆ·ä¿¡æ¯ä¹‹åï¼Œè¿›è¡Œç”¨æˆ·ä¿¡æ¯ä¿å­˜æ“ä½œ

      ```js
      // login.vue
      
         async _sendUserInfo (data) {
            const res = await this.$http.user_login(data)
            if (res) {
              this.updateUserInfo(res)
              uni.showToast({
                title: 'ç™»å½•æˆåŠŸ', icon: 'none',
              })
              setTimeout(() => { 
                 // #ifdef H5
                uni.switchTab({
                  url: '/pages/index/index'
                })
                // #endif
                // #ifndef H5
                uni.navigateBack()
                // #endif
              }, 2000)
            }
          }
          
      // mutation.js
      
      export default {
        updateUserInfo(state,userInfo) {
          uni.setStorageSync('userInfo',userInfo);
          state.userInfo = userInfo;
        }
      }
      ```

      â€‹	

   ## ç”¨æˆ·ç™»å½•-æ‰‹æœºéªŒè¯ç ç™»å½•

   

   #### ä¸€ã€éªŒè¯ç å¤„ç†

   1. è·å–æ‰‹æœºéªŒè¯çŠ¶æ€

   2. ä¿è¯send-codeè·å–formå¯¹è±¡

      ```react
      // SendCode.vue  
      this.$emit('getForm', form => this._sendCode(form))
      ```

   3. é€šè¿‡formè¿›è¡Œæ‰‹æœºå·ç å•ç‹¬éªŒè¯ï¼Œå¹¶è·å–æ‰‹æœºå·ç 

      ```js
      const { phone } = await form.validateField(['phone']);
      ```

   4. å¯åŠ¨å®šæ—¶å™¨ï¼Œè°ƒæ•´æ–‡æœ¬æ˜¾ç¤ºå†…å®¹

      ```js
       const timeId = setInterval(() => {
              if (this.time === 1) {
                clearInterval(timeId)
                this.runTime = false
                this.time = 60
                return
              }
              this.time--
            }, 1000)
      ```

   #### äºŒã€æ•°æ®å‘é€

   1. æ•°æ®å‘é€ï¼Œåˆ›å»ºäº‘å‡½æ•°

   2. å®šä¹‰unicloudçŸ­ä¿¡æœåŠ¡

      1. unicloudå¼€å‘ä¸­å¿ƒåœ°å€ï¼šhttps://dev.dcloud.net.cn/uniSms
      2. çŸ­ä¿¡å‚è€ƒé…ç½®åœ°å€ï¼šhttps://uniapp.dcloud.net.cn/uniCloud/send-sms

   3. å‰ç«¯æ¥å—è¿”å›å€¼ï¼Œä¿å­˜éªŒè¯ç ï¼ŒåŠ å…¥éªŒè¯ç éªŒè¯è§„åˆ™

   4. æäº¤ç”¨æˆ·æ•°æ®å‘é€ï¼ŒæŒ‡å®šå‚æ•°phoneåŠ typeç±»å‹




   ## æ”¶è—æŒ‰é’®ç»„ä»¶å®ç°

   ### ä¸€ã€å‰ç«¯å¤„ç†

   1. æ”¶è—å›¾æ ‡ç‚¹å‡»äº‹ä»¶å†…è·å–ç”¨æˆ·ä¿¡æ¯ï¼ŒåŠæ–‡ç« ä¿¡æ¯ï¼Œä¼ é€’åˆ°åç«¯

      ç”±äºå¤šä¸ªç•Œé¢ä¸­éƒ½ä¼šç”¨åˆ°userInfoå¯¹è±¡ï¼Œå¯å°†userInfoå¯¹è±¡æ”¾åœ¨ä¸€ä¸ªå…¨å±€çš„mixinä¸­è¿›è¡Œå°å­˜ï¼Œä¿è¯æ¯ä¸ªç•Œé¢æˆ–ç»„ä»¶å†…éƒ¨éƒ½å¯ä»¥è¿›è¡Œä½¿ç”¨

      1. å®šä¹‰commonMixinæ–‡ä»¶

         ```js
         import { mapState } from 'vuex'
         
         export default {
           install (Vue) {
             Vue.mixin({
               computed: {
                 ...mapState(['userInfo'])
               }
             })
           }
         }
         ```

      2. main.jsæ–‡ä»¶ä¸­å¯¹common Mixingæ–‡ä»¶è¿›è¡Œä½¿ç”¨

         ```js
         // main.js
         import commonMixin from './common/commonMixin.js'
         Vue.use(commonMixin)
         ```

         

   2. å°†ç”¨æˆ·IDåŠæ–‡ä»¶IDä½œä¸ºå‚æ•°ä¼ é€’ç»™äº‘å‡½æ•°

      1. åˆ›å»ºå…¨å±€æ£€æµ‹ç”¨æˆ·æ˜¯å¦ç™»å½•å‡½æ•°ï¼Œä¾›å¤šä¸ªç»„ä»¶è¿›è¡Œä½¿ç”¨ï¼ŒcommonMixinä¸­å®Œæˆ

         ```js
         // commonMixinæ–‡ä»¶
         checkedIsLogin () {
                   return new Promise(resolve => {
                     if (this.userInfo) {
                       resolve()
                     } else {
                       uni.navigateTo({
                         url: '/pages/userInfo/login/login'
                       })
                     }
                   })
                 }
         // saveLikeç»„ä»¶
         await this.checkedIsLogin();
         ```

      2. å°†æ–‡ç« ä¿¡æ¯ä¼ é€’åˆ°saveLikeç»„ä»¶å†…éƒ¨ä½¿ç”¨

         ```js
         //listCard ç»„ä»¶
         <SaveLikes :item="item"></SaveLikes>
         // saveLikeç»„ä»¶
          props: {
             item: Object
           }
         ```

      3. å‘é€æ•°æ®åˆ°äº‘æœåŠ¡å™¨

         ```js
          const res = await this.$http.upate_save_like({
                 articleId: this.item._id,
                 userId: this.userInfo._id
               })
         ```

      

   ### äºŒã€äº‘å‡½æ•°å®šä¹‰

   1. è·å–ç”¨æˆ·è®°å½•å€¼

   2. æ‰¾åˆ°æŒ‡å®šå­—æ®µarticle_likes_ids

   3. é€šè¿‡db.command æ›´æ–°æŒ‡ä»¤ä¿®æ”¹article_likes_ids

      å‚è€ƒåœ°å€ï¼šhttps://uniapp.dcloud.io/uniCloud/cf-database?id=query-command

      - å½“æ–‡ç« idå­˜åœ¨ï¼Œè¿›è¡Œåˆ é™¤æ“ä½œï¼Œä½¿ç”¨pullæ–¹æ³• å‚è€ƒåœ°å€ï¼šhttps://uniapp.dcloud.io/uniCloud/cf-database?id=pull
      - å½“æ–‡ç« idä¸å­˜åœ¨ï¼Œè¿›è¡Œæ·»åŠ æ“ä½œï¼Œä½¿ç”¨addToSetæ–¹æ³• å‚è€ƒåœ°å€:https://uniapp.dcloud.io/uniCloud/cf-database?id=addtoset

   4. å¤„ç†å®Œæˆï¼Œå°†article_likes_idsè¿›è¡Œä¿®æ”¹ä¹‹åï¼Œé‡æ–°å­˜å‚¨

      ```js
      'use strict';
      // å®šä¹‰æ•°æ®åº“å¼•ç”¨
      const db = uniCloud.database();
      // å®šä¹‰ä¿®æ”¹æŒ‡ä»¤
      const dbCmd = db.command
      
      exports.main = async (event, context) => {
      	const {
      		userId,
      		articleId
      	} = event
      	// è·å–ç”¨æˆ·Idsé›†åˆ
      	const userInfo = await db.collection('user').doc(userId).get();
      
      	const articleIds = userInfo.data[0].article_likes_ids
      	let returnMsg = null
      
      	let articleArr = null;
      	// å¦‚æœåŒ…å«åˆ é™¤æ”¶è—
      	if (articleIds.includes(articleId)) {
      		articleArr = dbCmd.pull(articleId)
      		returnMsg = 'å–æ¶ˆæ”¶è—æˆåŠŸ'
      	} else {
      		articleArr = dbCmd.addToSet(articleId)
      		returnMsg = 'æ·»åŠ æ”¶è—æˆåŠŸ'
      	}
      
      	await db.collection('user').doc(userId).update({
      		article_likes_ids: articleArr
      	})
      
      	const updateUserInfo = await db.collection('user').doc(userId).get()
      
      	//è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯
      	return {
      		code: 0,
      		data: {
      			msg: returnMsg,
      			newUserInfo:updateUserInfo.data[0]
      		}
      	}
      };
      
      ```

   ### è·å–æ•°æ®åå‰ç«¯å¤„ç†

   1. ä¿®æ”¹å­˜å‚¨çš„ç”¨æˆ·ä¿¡æ¯article_likes_idsæ•°ç»„

      ```js
      // saveLikesç»„ä»¶å¤„ç†
      this.updateUserInfo({ ...this.userInfo, ...newUserInfo })
      ```

   2. å¼¹å‡ºæç¤ºä¿¡æ¯

   3. é‡æ–°å¯¹ä¿å­˜çŠ¶æ€iconå›¾æ ‡èµ‹å€¼

      ä½¿ç”¨è®¡ç®—å±æ€§å¤„ç†ç”¨æˆ·æ”¶è—ä¿å­˜çŠ¶æ€

      ```js
       computed: {
          isLike () {
            return this.userInfo && this.userInfo.article_likes_ids.includes(this.item._id)
          }
        }
      ```


   ## æœç´¢é¡µé¢-ç»“æ„æ­å»º

   ### ä¸€ã€è°ƒæ•´navBarä¸ºåŠ¨æ€ç»„ä»¶

   > æ·»åŠ æ˜¯å¦ä¸ºæœç´¢ç•Œé¢åˆ¤æ–­

   1. isSearchï¼Œå½“ç•Œé¢ä¸ºæœç´¢ç•Œé¢æ—¶ï¼Œæ·»åŠ è¿”å›iconå›¾æ ‡

   ```html
    <!--å½“ç•Œé¢ä¸ºæœç´¢ç•Œé¢çš„æ—¶å€™ï¼Œæ·»åŠ å›é€€æŒ‰é’®  -->
         <view :style="{top:statusHeight + 'rpx'}" class="return-icon" v-if="isSearch">
           <uni-icons type="back" size="22" color="white"></uni-icons>
         </view>
   
   <style>
      /* æœç´¢ç•Œé¢å•ç‹¬æ·»åŠ æ ·å¼ */
       .return-icon {
           position: absolute;
           left: 0;
           top: 50%;
           height: 60rpx;
           @include flex(center);
       }
   </style>
   ```

      2. ä¸ºç‚¹å‡»äº‹ä»¶æ·»åŠ æ¡ä»¶å¤„ç†ï¼Œå½“ä¸ºæœç´¢ç•Œé¢æ—¶ï¼Œé˜»æ­¢è·³è½¬äº‹ä»¶
    
         ```js
         	if (this.isSearch) return
         				uni.navigateTo({
         					url: '/pages/search/search'
         				})
         ```

   3. è°ƒæ•´æ ·å¼å¤„ç†ï¼Œæ ¹æ®æ¡ä»¶æ·»åŠ ğŸ”™æŒ‰é’®ï¼Œå¹¶ç»‘å®šè¿”å›äº‹ä»¶

      ```html
         *<!--å½“ç•Œé¢ä¸ºæœç´¢ç•Œé¢çš„æ—¶å€™ï¼Œæ·»åŠ å›é€€æŒ‰é’®  -->*
      
         â€‹      *<*view @click="returnArticleList" :style="{top:statusHeight + 'rpx'}" class="return-icon" v-if="isSearch"*>*
      
         â€‹        *<*uni-icons type="back" size="22" color="white"*></*uni-icons*>*
      
         â€‹      *</*view*>*
      
      
      ```

   4. æ·»åŠ å›é€€äº‹ä»¶ï¼Œæ ¹æ®å¹³å°ä½¿ç”¨æŒ‡å®šäº‹ä»¶

      ```js
      	// è¿”å›æ–‡ç« åˆ—è¡¨ç•Œé¢
      			returnArticleList() {
      				// #ifdef H5
      				uni.switchTab({
      					url: '../../pages/index/index'
      				})
      				// #endif
      				// #ifndef H5
      				uni.navigateBack()
      				// #endif
      
      			}
      ```

      

   ### äºŒã€æœç´¢ç•Œé¢ç»“æ„æ­å»º

   > â€‹	æ ¹æ®å½“å‰çŠ¶æ€ï¼Œè¿›è¡Œå†…å®¹æ¡ä»¶æ¸²æŸ“

   ```html
     <view class="search-container">
       <!-- æœç´¢å¯¼èˆªç»„ä»¶ -->
       <NavBar :isSearch="isSearch"></NavBar>
       <!-- æœç´¢åŒ…è£¹ -->
       <view class="search-wrapper">
         <!-- æ²¡æœ‰è¿›è¡Œæœç´¢çš„æ“ä½œ -->
         <view v-if="false" class="search-history-container">
           <!-- å¤´éƒ¨ -->
           <view class="search-header">
             <text class="history-text">æœç´¢å†å²</text>
             <text class="history-clean">æ¸…ç©º</text>
           </view>
           <!-- å†…å®¹éƒ¨åˆ† -->
           <view class="search-history-content">
             <view class="history-content-item" v-for="item in 10" :key="item">ç›´æ’­</view>
           </view>
   
           <view class="no-data">å½“å‰æ²¡æœ‰æœç´¢å†å²</view>
         </view>
   
         <!-- å¼€å§‹è¿›è¡Œæœç´¢çš„æ“ä½œ -->
         <view v-else class="search-list-container">
           <ListItem v-if="searchList.length"></ListItem>
            <view v-else class="no-data">æ²¡æœ‰æœç´¢åˆ°ç›¸å…³æ•°æ®</view>
         </view>
       </view>
     </view>	
   ```

   ## æœç´¢ç•Œé¢-ä¸šåŠ¡é€»è¾‘å¤„ç†

   ### ä¸€ã€è·å–æ–‡æœ¬è¾“å…¥å†…å®¹

   â€‹	inputç»„ä»¶å‚è€ƒåœ°å€ï¼š[https://uniapp.dcloud.io/component/input?id=input](https://uniapp.dcloud.io/component/input?id=input)

   1. æ·»åŠ å³ä¸‹è§’ç‚¹å‡»æŒ‰é’®äº‹ä»¶

   2. è°ƒæ•´å³ä¸‹è§’æ˜¾ç¤ºæ–‡å­—

   3. çˆ¶å­ç»„ä»¶å®ç°æ•°æ®åŒå‘ç»‘å®š

      ```js
      // NavVarç»„ä»¶
       computed: {
          // åŠ¨æ€è·å–searchvalueå†…å®¹
          searchVal: {
            get () {
              return this.parentVal
            },
            set (val) {
              this.$emit('updateVal', val)
              if (!val) {
                this.$emit('sendSearchData')
              }
            }
          }
        }
      ```

   4. å¤„ç†ç©ºæ•°æ®å†…å®¹ï¼Œæ¸…ç©ºæ“ä½œåè¿”å›ä¸€ä¸ªç©ºçš„searchList

   ### äºŒã€äº‘å‡½æ•°å®šä¹‰å¹¶è¿”å›æ•°æ®

   1. å®šä¹‰äº‘å‡½æ•°

   ```js
    const list = await db.collection('article')
       .aggregate() // ä½¿ç”¨èšåˆçš„å½¢å¼è¿›è¡Œæ•°æ®çš„è·å–
       // ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ï¼Œåªè¦æ˜¯åŒ…å«ï¼Œå°±è¿›è¡Œè¿”å›æ“ä½œ
       .match({ title: new RegExp(searchVal) })
       .project({
         content: 0 // æœ¬æ¬¡æŸ¥è¯¢ä¸éœ€è¦è¿”å›æ–‡ç« è¯¦æƒ…ç»™å‰ç«¯
       })
       .end()
   ```

   2. å‰ç«¯è¿›è¡Œæ•°æ®æ¸²æŸ“å¤„ç†

      ```js
        async _sendSearchData (val) {
            if (!this.parentVal) {
              this.searchList = []
              return
            }
             const { articleList, total } = await this.$http.get_search_data({ searchVal: this.parentVal })
            this.searchList = articleList
            this.total = total
          }
      ```

   ### ä¸‰ã€å¤„ç†å†å²è®°å½•åˆ‡æ¢æ˜¾ç¤º

   1. å®šä¹‰ç°å®çŠ¶æ€æ ‡è¯†

      ```js
      // searchPage
       data() {
         return {
           isShowHistory:true,
            historyList:[],
         }
       }
      ```

   2. ç‚¹å‡»å¡ç‰‡ç”Ÿæˆå†å²è®°å½•

      é€šè¿‡è‡ªå®šä¹‰äº‹ä»¶å½¢å¼ä¼ é€’æ•°æ®åˆ°searchç•Œé¢

      ```js
       openHistory(val) {
            this.parentVal = val
            this._sendSearchData()
          }
      ```

   3. ç‚¹å‡»å¡ç‰‡å®ç°æœç´¢å†…å®¹ä¿å­˜

      ```js
      // searchPaage  
      openHistory(val) {
            this.parentVal = val
            this._sendSearchData()
          }
      // mutaitions.jså¤„ç†
        // è®¾ç½®å†å²æ”¶è—ä¿¡æ¯
        setHistory (state, val) {
          let list = state.historyList;
          // åˆ¤æ–­æ˜¯å¦åŒ…å«å½“å‰æœç´¢çš„å†…å®¹ï¼ŒåŒ…å«ç›´æ¥ä¸æ‰§è¡Œä»»ä½•æ“ä½œ
          if (list.length > 0 && list.findIndex(item => item === val) > -1) return
          list.unshift(val);
          uni.setStorageSync('historyList', list)
          state.historyList = list;
        },
       // state.jsè¿›è¡Œåˆå§‹å€¼ç»‘å®š
       export default {
        historyList: uni.getStorageSync('historyList') || []
      }
      ```

   4. ç‚¹å‡»å†å²è®°å½•æ–‡å­—å®ç°æœç´¢åŠŸèƒ½

      ```js
        // å¼¹å‡ºæœç´¢å†…å®¹
          openHistory(val) {
            this.parentVal = val
            this._sendSearchData()
          },  
      ```

      

   5. å®ç°ç‚¹å‡»æ¸…ç©ºæŒ‰é’®å¤„ç†æ¸…ç©ºå†å²è®°å½•æ“ä½œï¼Œé€šè¿‡listCardå‘é€è‡ªå®šä¹‰äº‹ä»¶ï¼ŒsearchPageæ¥æ”¶åˆ°è‡ªå®šä¹‰äº‹ä»¶åï¼Œé€šè¿‡å‡ºå‘mutationé‡Œé¢çš„æŒ‡å®šäº‹ä»¶ï¼Œè¿›è¡Œstateçš„æŒ‡å®šå±æ€§æ¸…ç©ºæ“ä½œ

      ```js
      // mutations.js
        // æ¸…ç©ºæœç´¢å†å²ä¿¡æ¯
        cleanHistory (state) {
          uni.removeStorageSync('historyList')
          state.historyList = []
          uni.showToast({
            title: "æ¸…ç©ºå®Œæˆ",
            icon: "success"
          })
        }
      ```

      ## æ ‡ç­¾é¡µé¢-ç»“æ„æ­å»º

      ### ä¸€ã€åˆ›å»ºæ ‡ç­¾é¡µé¢ï¼Œå®Œæˆç»“æ„æ ·å¼å¤„ç†

      1. åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•ï¼Œæœªç™»å½•ç›´æ¥è·³è½¬ç™»å½•ç•Œé¢

      2. æ˜¾ç¤ºç»“æ„åŠæ ·å¼å¤„ç†

      3. éšå¼æ ·å¼å¤„ç†


      ### äºŒã€æ§åˆ¶æ ‡æŒ‰é’®çŠ¶æ€
    
      1. æ·»åŠ çŠ¶æ€å±æ€§ç›‘å¬ï¼Œå®ç°åˆ‡æ¢æŒ‰é’®æ–‡æœ¬åŠæ˜¯å¦è¿›è¡Œæ ‡ç­¾æä¿®æ”¹å‘é€æ“ä½œ
    
      ### ä¸‰ã€è°ƒæ•´labelListä¸ºå…¨å±€å…¬å…±çŠ¶æ€
    
      1. storeå®šä¹‰labelListå±æ€§
      2. åœ¨articleListç•Œé¢è¿›è¡ŒlabelListå¼•ç”¨æ›¿æ¢

   ## æ ‡ç­¾é¡µé¢-é€‰é¡¹å¡ä¸šåŠ¡é€»è¾‘å¤„ç†

   ### ä¸€ã€åˆ›å»ºæˆ‘çš„æ ‡ç­¾åŠæ¨èæ ‡ç­¾æ•°ç»„

   1. ä½¿ç”¨è®¡ç®—å±æ€§è¿›è¡Œæ•°ç»„åˆ›å»º

      ```js
      selfLabelList () {
            return this.labelList.filter(item => this.labelIds.includes(item._id))
          },
          recommentLabelList () {
            return this.labelList.filter(item => !this.labelIds.includes(item._id) && item._id)
          },
      ```

   2. åˆå§‹åŒ–å®šä¹‰æœ¬åœ°æ•°æ®å¯¹è±¡

      > ä¸ºäº†ä¸å½±å“ç”¨æˆ·æ•°æ®ï¼Œé¡µé¢å†…å®šä¹‰å±æ€§è¿›è¡Œç”¨æˆ·æ•°ç»„ä¿¡æ¯æ•°æ®æ‹·è´,watchä¸­è¿›è¡Œè°ƒç”¨,ä¸ºäº†é˜²æ­¢ç”¨æˆ·åœ¨ä¿®æ”¹ä¹‹åï¼Œè¿›è¡Œç”¨æˆ·çš„æ”¹å˜æ— æ³•è·å–å‡†ç¡®çš„å†…å®¹ï¼Œé€šè¿‡watchä¸­è¿›è¡Œæ‹·è´æ“ä½œï¼Œå¹¶ä½¿ç”¨immediateåˆå§‹è¯è¿›è¡Œwatchä½¿ç”¨

      ```js
        watch: {
          userInfo: {
            immediate: true,
            handler (newVal, oldVal) {
              this.labelIds = [...(this.userInfo.label_ids)]
            }
          }
        },
      ```

   3. è¿›è¡Œé¡µé¢æ•°æ®æ¸²æŸ“

      ```html
      // ç”¨æˆ·æ ‡ç­¾ç»„
              <view class="label-content-item" v-for="(item,index) in selfLabelList" :key="index">
                {{item.name}}
                <uni-icons @click="deleteLabelItem(item)" v-if="isEdit" class="icon-close" type="clear" size="20" color="red"></uni-icons>
              </view>
              <view v-if="!selfLabelList.length" class="no-data">å½“å‰æ²¡æœ‰æ•°æ®</view>
            </view>
      
      // æ¨èæ ‡ç­¾ç»„
      <view class="label-content">
              <view class="label-content-item" @click="changeSelfList(item)" v-for="(item,index) in recommentLabelList" :key="index">
                {{item.name}}
              </view>
              <view v-if="!recommentLabelList.length" class="no-data">å½“å‰æ²¡æœ‰æ•°æ®</view>
      </view>
      ```

   4. ä¸ºæ ‡ç­¾åˆ‡æ¢æ·»åŠ ç‚¹å‡»äº‹ä»¶

      > æ ‡ç­¾åˆ‡æ¢è¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„ï¼Œåœ¨isEditæƒ…å†µä¸‹åœ¨è¿›è¡Œæ ‡ç­¾åˆ‡æ¢æ“ä½œã€‚ï¼Œè¿½åŠ ç”¨æˆ·æ ‡ç­¾ï¼Œç›´æ¥ä¿®æ”¹labelIds,åˆ é™¤æ ‡ç­¾ï¼Œç›´è¿‡æ»¤åŒ¹é…å†…å®¹ã€‚åœ¨æœªç‚¹å‡»ä¿å­˜æŒ‰é’®çš„æ—¶å€™ï¼Œä¸éœ€è¦è¿›è¡ŒæŒ¯æ­£æ•°æ®å­˜å‚¨

      ```js
       //ä¿®æ”¹å½“å‰ç”¨æˆ·çš„labelList 
          changeSelfList (item) {
            if (!this.isEdit) return
            this.labelIds.push(item._id)
          },
          // åˆ é™¤ç”¨æˆ·é€‰é¡¹å†…å®¹
          deleteLabelItem (item) {
            this.labelIds = this.labelIds.filter(val => val !== item._id)
          }
      ```

   ### äºŒã€æ•°æ®å‘é€

   1. å‰ç«¯æ”¶é›†æ•°æ®ï¼Œå½“å‰ç”¨æˆ·IDï¼ŒåŠç°é˜¶æ®µæ”¶è—çš„æ•°ç»„ selfIds

      ```js
       const label_ids = this.selfLabelList.map(item => item._id)
            const res = await this.$http.update_label_ids({ userId: this.userInfo._id, label_ids });
           
      ```

   2. åˆ›å»ºäº‘å‡½æ•°ã€‚ä¿®æ”¹æ•°æ®åº“ä¸­ç”¨æˆ·label_idså­—æ®µ

      ```js
      'use strict';
      const db = uniCloud.database()
      exports.main = async (event, context) => {
      	//eventä¸ºå®¢æˆ·ç«¯ä¸Šä¼ çš„å‚æ•°
      	const {userId,label_ids} = event
      	
      	const res = await  db.collection('user').doc(userId).update({
      		label_ids
      	})
      	//è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯
      	return {
      		code:0,
      		data:{
      			msg:"ä¿®æ”¹æˆåŠŸ"
      		}
      	}
      };
      ```

   3. å‰ç«¯æ¥æ”¶è¿”å›å€¼ï¼Œé‡æ–°è°ƒæ•´userInfoå³å¯ã€‚

      ```js
       uni.showToast({
              title: res.msg
            })
            this.updateUserInfo({ ...this.userInfo, label_ids });
      ```

   ### ä¸‰ã€å¤„ç†å…¶ä»–ç•Œé¢å‰¯ä½œç”¨

   1. â€‹	è°ƒæ•´indexç•Œé¢labelListè·å–æ–¹å¼,åˆ¤æ–­æ˜¯å¦åŒ…å«ç”¨æˆ·ä¿¡æ¯ï¼Œä¸åŒ…å«ç›´æ¥è¿”å›ï¼Œå¦åˆ™ï¼Œæ˜¾ç¤ºç”¨æˆ·æœè—å†…å®¹

      ```js
      computed: {
          labelList () {
            if (this.userInfo) {
              this.activeIndex = 0;
              return [...this.$store.state.labelList.slice(0,1),...this.$store.state.labelList.filter(item => this.userInfo.label_ids.includes(item._id))]
            } else {
              return this.$store.state.labelList
            }
          },
      ```

   2. articleé¡µé¢å†…éƒ¨å…¼å¬åˆ°userListæ”¹å˜å€¼åï¼Œæ¸…ç©ºåˆ—è¡¨å¯¹è±¡

      ```js
        watch: {
          labelList (newVal, OldVal) {
            this.articleData = {}
            this.loadData = {}
            this._getArticleList(this.activeIndex)
          },
        },
      ```


   ## æ–‡ç« è¯¦æƒ…é¡µé¢-ç»“æ„æ ·å¼å¤„ç†

   

   **demo**

   ![image-20230213115321365](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131153486.png)

   ### ä¸€ã€åŸºæœ¬ç»“æ„

   â€‹		

   ```html
   <template>
   	<view class="article-detail-container">
   		<view class="detail-title">
   			ssråŸºæœ¬ä»‹ç»ä»¥åŠAPIçš„ä½¿ç”¨
   		</view>
   		<view class="detail-header">
   			<view class="detail-logo">
   				<image src="../../static/img/logo.jpeg" mode="aspectFill"></image>
   			</view>
   			<view class="detail-header-content">
   				<view class="detail-header-content-title">
   					WEBè®²å¸ˆ
   				</view>
   				<view class="detail-header-content-info">
   					<text>2020.03.16 17:50</text>
   					<text>173 æµè§ˆ</text>
   					<text>6 èµ</text>
   				</view>
   			</view>
   			<button type="default" class="detail-header-button">å–æ¶ˆå…³æ³¨</button>
   		</view>
   		<view class="detail-content-container">
   			<view class="detail-html">
   				æ–‡æœ¬å†…å®¹
   			</view>
   		</view>
   
   		<!-- è¯„è®ºç»„ä»¶ -->
   		<view class="detail-bottom">
   			<view class="input-container">
   				<text>è°ˆè°ˆä½ çš„çœ‹æ³•</text>
   				<uni-icons type="compose" size="16" color="#f07373"></uni-icons>
   			</view>
   			<view class="detail-bottom-icons">
   				<view class="detail-bottom-icon-box">
   					<uni-icons type="chat" size="22" color="#f07373"></uni-icons>
   				</view>
   				<view class="detail-bottom-icon-box">
   					<uni-icons type="heart" size="22" color="#f07373"></uni-icons>
   				</view>
   				<view class="detail-bottom-icon-box">
   					<uni-icons type="hand-thumbsup" size="22" color="#f07373"></uni-icons>
   				</view>
   			</view>
   		</view>
   	</view>
   </template>
   ```

   

   ### äºŒã€åˆå§‹åŒ–æ ·å¼

   â€‹	

   ```css
   .article-detail-container {
   	padding: 30rpx 0 108rpx;
   }
   
   .detail-title {
   	padding: 0 30rpx;
   	font-size: 36rpx;
   	font-weight: bold;
   }
   
   .detail-header {
   	@include flex(flex-start);
   	margin-top:20rpx;
   	padding: 0 30rpx;
   	.detail-logo {
   		flex-shrink: 0;
   		width: 80rpx;
   		height: 80rpx;
   		border-radius: 50%;
   		overflow: hidden;
   		image {
   			width: 100%;
   			height: 100%;
   		}
   	}
   	.detail-header-content {
   		width: 100%;
   		padding-left: 20rpx;
   		@include flex(space-between,column);
   		font-size: 24rpx;
   		align-items: flex-start;
   		.detail-header-content-title {
   			font-size: 28rpx;
   			color: #333;
   		}
   		.detail-header-content-info {
   			color: $c-9;
   			text {
   				margin-right: 20rpx;
   			}
   		}
   	}
   	.detail-header-button {
   		padding: 0 30rpx;
   		flex-shrink: 0;
   		height: 60rpx;
   		line-height: 60rpx;
   		border-radius: 10rpx;
   		font-size: 24rpx;
   		color: #FFFFFF;
   		background-color: $base-color;
   	}
   }
   
   .detail-content-container {
   	margin-top: 40rpx;
   	// min-height: 1000rpx;
   	.detail-html {
   		padding: 0 30rpx;
   	}
   }
   
   .detail-bottom {
   	position: fixed;
   	bottom: 0;
   	left: 0;
   	@include flex(flex-start);
   	width: 100%;
   	height: 88rpx;
   	border-top: 1px #f5f5f5 solid;
   	background-color: #FFFFFF;
   	box-sizing: border-box;
   	.input-container {
   		@include flex();
   		margin-left: 20rpx;
   		padding: 0 20rpx;
   		flex-grow: 1;
   		height: 60rpx;
   		border: 1px solid #ddd;
   		border-radius: 5px;
   		text {
   			font-size: 28rpx;
   			color: $c-9;
   		}
   	}
   	.detail-bottom-icons {
   		display: flex;
   		flex-shrink: 0;
   		padding: 0 20rpx;
   	}
   	.detail-bottom-icon-box {
   		position: relative;
   		@include flex(center);
   		width: 88rpx;
   	}
   }
   ```

   ## æ–‡ç« è¯¦æƒ…é¡µé¢-æ•°æ®åˆå§‹åŒ–æ¸²æŸ“

   

   ### ä¸€ã€URLå‚æ•°å¤„ç†

   > â€‹	åœ¨listcardç»„ä»¶è·³è½¬è¿‡ç¨‹ä¸­æºå¸¦å‚æ•°åˆ°è¯¦æƒ…ç•Œé¢å®ç°æ•°æ®ä¸æ¸²æŸ“

   â€‹		**å¡ç‰‡ç»„ä»¶**

   ```js
     /* æ·»åŠ å‚æ•°ä¼ é€’ */
         const { _id, title, author, create_time, thunbs_up_count, browse_count } = this.item
         const params = { _id, title, author, create_time, thunbs_up_count, browse_count };
         uni.navigateTo({url: `../../pages/articleDetail/articleDetail?params=${JSON.stringify(params)}`})
   ```

   â€‹        **æ–‡ç« è¯¦æƒ…ç•Œé¢**

   ```js
   onLoad (...options) {
       this.articleData = JSON.parse(options[0].params)
     },
   ```

   â€‹		**è·å–æ•°æ®åè¿›è¡ŒUIç•Œé¢æ¸²æŸ“**

   ### äºŒã€è¿›è¡Œæ•°æ®è¯·æ±‚å‘é€

   1. å‰ç«¯æºå¸¦å½“å‰æ–‡ç« IDè¿›è¡Œå‚æ•°ä¼ é€’

   2. å®šä¹‰äº‘å‡½æ•°

      ```js
      'use strict';
      const db = uniCloud.database();
      exports.main = async (event, context) => {
        const { article_id } = event;
      
        const articleList = await db.collection('article')
          .aggregate()
          .match({
            _id: article_id
          })
          .end();
      
      
      
        //è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯
        return {
          code: 0,
          msg: "æ–‡ç« è·å–æˆåŠŸ",
          data: articleList.data[0]
        }
      };
      ```

   3. è·å–æ•°æ®åæ›´æ–°articleDataæ•°æ®

      1. è§£æå†…å®¹æ•°æ®ä½¿ç”¨ä¸‰æ–¹æ’ä»¶uParse 

      2. ä¸‹è½½åœ°å€ï¼š[https://ext.dcloud.net.cn/plugin?id=364](https://ext.dcloud.net.cn/plugin?id=364)

      3. è§£æmarkdownæ–‡æœ¬ä½¿ç”¨ä¸‰æ–¹æ’ä»¶marked

         ä¸‹è½½ï¼šnpm install markdown | yarn markdown 

         ä½¿ç”¨ï¼š

         

         ```js
          content () {
               try {
                 return marked(this.articleData.content)
               } catch (e) {
                 return null
               }
             }
         ```




   ## æ–‡ç« è¯¦æƒ…é¡µé¢-è¯„è®ºç»„ä»¶åˆ¶ä½œ

   

   > å½“ç”¨æˆ·ä¸ºæœªç™»å½•çŠ¶æ€ï¼Œå…ˆè¿›è¡Œç™»å½•ç•Œé¢è·³è½¬æ“ä½œ

   ### ä¸€ã€æ·»åŠ ä¸‰æ–¹æ’ä»¶

   1. æ’ä»¶å¸‚åœºå†…ä¸‹è½½æ’ä»¶uni-popup ä¸‹è½½åœ°å€ï¼š[https://ext.dcloud.net.cn/plugin?id=329](https://ext.dcloud.net.cn/plugin?id=329)

   2. å®šä¹‰å¼¹å‡ºå±‚ç»„ä»¶CommentMaskerï¼Œä¼ é€’æ˜¯å¦æ‰“å¼€å¼¹çª—æ ‡è¯†

      ```html
       <CommentMasker  :showPopup="showPopup"></CommentMasker>
      ```

   3. å®Œæˆå†…å®¹åŒºåŸŸç»“æ„æ ·å¼åˆ›å»º

      ```css
      <style lang="scss">
      .popup-wrapper {
        background-color: #ffffff;
        .popup-header {
          @include flex();
          font-size: 28rpx;
          color: #666;
          border-bottom: 1px #f5f5f5 solid;
          .popup-header-item {
            height: 100rpx;
            line-height: 100rpx;
            padding: 0 30rpx;
          }
        }
        .popup-content {
          width: 100%;
          padding: 30rpx;
          box-sizing: border-box;
          .popup-content-textarea {
            height: 400rpx;
            width: 100%;
          }
          .popup-content-count {
            @include flex(flex-end);
            font-size: 24rpx;
            color: $c-9;
          }
        }
      }
      </style>
      ```

   äºŒã€äº‘å‡½æ•°è¿›è¡Œè¯„è®ºå†…å®¹ä¿å­˜

   1. å‰ç«¯è¿›è¡Œæ•°æ®æ”¶é›†,è·å–ç”¨æˆ·idï¼Œæ–‡ç« idï¼Œè¯„è®ºå†…å®¹

   2. åˆ›å»ºäº‘å‡½æ•°,ä¸ºarticleè¿›è¡Œè¯„è®ºå†…å®¹è¿½åŠ 

      ```
        let commentObj = {
          comment_id: generatedId(5),
          comment_content: content,
          create_time: Date.now(),
          is_reply: false,
          author: {
            author_id: user._id,
            author_name: user.author_name,
            avatar: user.avatar,
            professional: user.professional
          },
          replyArr: []
        }
      
        commentObj = dbCmd.unshift({ commentObj })
        await db.collection('article').doc(articleId).update({
          comments: commentObj
        })
      ```

      â€‹		ä¸ºcomment_idæŒ‡å®šéšæœºidå€¼

      ```js
      function generatedId (num) {
          return Number(Math.random().toString().substr(3, num) + Date.now()).toString(36)
        }
      ```

   3. è¿”å›æ•°æ®åˆ°å‰ç«¯ï¼Œå‰ç«¯è¿›è¡Œå¼¹çª—å…³é—­æ“ä½œ

      ```js
         async _sendCommentData (content) {
            const {msg} = await this.$http.update_comment({ articleId: this.articleData._id, userId: this.userInfo._id ,content})
            uni.showToast({
              title:msg,
            })
            this.showPopup = false;
          }
      ```


   ## æ–‡ç« è¯¦æƒ…é¡µé¢-è¯„è®ºå±•ç¤ºç»„ä»¶åˆ¶ä½œ

   

   ### ä¸€ã€ç•Œé¢ç»“æ„æ­å»º

   > ä¸‹è½½æ—¥æœŸæ ¼å¼åŒ–ç»„ä»¶ï¼Œä¸‹è½½åœ°å€ï¼š[https://ext.dcloud.net.cn/plugin?id=3279](https://ext.dcloud.net.cn/plugin?id=3279)

   ### äºŒã€å®šä¹‰äº‘å‡½æ•°ï¼Œè¿›è¡Œå†…å®¹è·å–

   1. å‰ç«¯è¿›è¡Œäº‘å‡½æ•°è¯·æ±‚

      ```js
       async _getCommentList () {
            const res = await this.$http.get_comments({ articleId: this.formData._id })
          }
      ```

   2. å®šä¹‰äº‘å‡½æ•° get_comments 

      ```js
      'use strict';
      const db = uniCloud.database();
      exports.main = async (event, context) => {
        const {
          articleId,
          pageSize = 10,
          page = 1
        } = event;
      
        const list = await db.collection('article')
          .aggregate()
          .match({
            _id: articleId,
          })
          .unwind('$comments') // ä»æŒ‡å®šçš„èŠ‚ç‚¹è¿›è¡Œå†…å®¹çš„è·å–
          .project({
            _id: 0,
            comments: 1
          })
          .replaceRoot({
            newRoot: '$comments'
          })
          .skip(pageSize * (page - 1))
          .limit(pageSize)
          .end()
      
        //è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯
        return {
          code: 0,
          msg: 'æ•°æ®è¯·æ±‚æˆåŠŸ',
          data: list.data
        }
      };
      
      ```

   3. å‰ç«¯è¿›è¡Œå†…å®¹æ¸²æŸ“

      ```js
       <view class="comment-box">
          <view class="comment-header">
            <view class="comment-header-logo">
              <image :src="commentData.author.avatar" mode="aspectFill"></image>
            </view>
            <view class="comment-header-info">
              <view class="title">
                {{commentData.author.author_name}}
              </view>
              <view class="">
                <uni-dateformat :date="commentData.create_time" format="yyyy-MM-dd hh:mm:ss"></uni-dateformat>
              </view>
            </view>
          </view>
          <!-- å†…å®¹éƒ¨åˆ† -->
          <view class="comment-content">
            <view class="">
              {{commentData.comment_content}}
            </view>
            <view class="comment-info">
              <view class="comment-button">
                å›å¤
              </view>
            </view>
          </view>
        </view>
      ```


   ## æ–‡ç« è¯¦æƒ…é¡µé¢-æŒ‡å®šè¯„è®ºå†…å®¹å¤„ç†

   

   ### ä¸€ã€æŒ‡å®šè¯„è®ºå›å¤æŒ‰é’®ç‚¹å‡»äº‹ä»¶ç»‘å®š

   1. æ·»åŠ comment_idä¼ é€’ç»™äº‘å‡½æ•°ï¼Œä¿è¯äº‘å‡½æ•°çŸ¥é“å½“å‰æ˜¯é’ˆå¯¹é‚£æ¡è¯„è®ºè¿›è¡Œçš„å›å¤

   ### äºŒã€äº‘å‡½æ•°è°ƒæ•´

   1. â€‹	ä»å½“å‰çš„commnetsé›†åˆå½“ä¸­é€šè¿‡ä¼ é€’çš„comment_idè·å–æŒ‡å®šçš„é‚£ä¸€æ¡è®°å½•å€¼

   2. ä¸ºå½“å‰çš„è®°å½•å€¼çš„replyArrå±æ€§æ’å…¥ä¸€ä¸ªæ–°çš„è¯„è®ºå†…å®¹

      ```js
      // è·å–æŒ‡å®šçš„è¯„è®ºå†…å®¹
      let commentIndex = comments.findIndex(item => item.comment_id === comment_id)
      ```

   3. ä¿®æ”¹æŒ‡å®šå‘¢ç´¢å¼•å€¼çš„æ•°æ®çš„replyArrçš„è®°å½•å€¼

      ```js
      commentObj = {
      			[commentIndex]: {
      				replyArr: dbCmd.unshift(commentObj)
      			}
      		}
      ```

   ### ä¸‰ã€å‰ç«¯è¿›è¡Œæ•°æ®æ¸²æŸ“

   > â€‹	ä½¿ç”¨ç»„ä»¶è‡ªè°ƒç”¨çš„å½¢å¼è¿›è¡Œæ•°æ®æ¸²æŸ“

   1. â€‹	åœ¨è‡ªè°ƒç”¨çš„è¿‡ç¨‹å½“ä¸­éœ€è¦æ³¨æ„ï¼Œä¿è¯è°ƒç”¨æ—¶è¿›è¡ŒæŒ‡å®šnameå±æ€§å€¼ï¼Œ

   2. ä½¿ç”¨è‡ªè°ƒç”¨çš„è¿‡ç¨‹ä¸­ä¼šæœ‰ä¸¤æ¬¡çˆ¶ç»„å»ºäº‹ä»¶å‘é€çš„è¿‡ç¨‹ï¼Œä¸€æ¬¡æ˜¯å½“å‰ç»„ä»¶ä½œä¸ºçˆ¶ç»„ä»¶çš„æ—¶å€™è·å–åˆ°å‘é€çš„äº‹ä»¶ï¼Œå¦ä¸€æ¬¡æ˜¯å‘ä¸Šçº§articleDetailä¼ é€’çš„æ—¶å€™æ¥æ”¶åˆ°çš„äº‹ä»¶ã€‚

   3. å½“æŒ‡å®šå›å¤è¿›è¡Œäº‹ä»¶å‘é€çš„æ—¶å€™ï¼Œéœ€è¦æŒ‡å®šreply_id,å¹¶ä¸”è°ƒæ•´comment_idå€¼ï¼›

   4. æ¸²æŸ“å®Œæˆä¹‹åï¼Œå°†replayDataè¿›è¡Œæ¸…ç©ºå¤„ç†

   ## æ–‡ç« è¯¦æƒ…é¡µé¢-å…³æ³¨ä½œè€…

   

   ### ä¸€ã€UIæ˜¾ç¤ºå¤„ç†

   > åˆ¤æ–­å½“å‰çš„ç™»å½•ç”¨æˆ·æ˜¯å¦åŒ…å«æ–‡ç« ä½œè€…çš„ç”¨æˆ·ID

   ```js
   // æ·»åŠ è®¡ç®—å±æ€§ 
   isFollowAuthor() {
         return this.userInfo && this.userInfo.author_likes_ids.includes(this.articleData.author.id)
       }
   ```

   ### äºŒã€äº‹ä»¶ç»‘å®š

   > â€‹	ä¼ é€’æ–‡ç« ä½œè€…IDï¼ŒåŠå½“å‰ç™»å½•ç”¨æˆ·ID

   ```js
   const { msg } = await this.$http.update_follow_author({ authorId: this.articleData.author.id, userId: this.userInfo._id })
   
   ```

   ### ä¸‰ã€äº‘å‡½æ•°å®šä¹‰

   ```js
   'use strict';
   const db = uniCloud.database();
   const dbCmd = db.command;
   exports.main = async (event, context) => {
     const {
       userId,
       authorId
     } = event;
   
     const user = await db.collection('user').doc(userId).get();
     const authorLikesIds = user.data[0].author_likes_ids
     let returnMsg = ''
   
     let author_ids = null
     if (authorLikesIds.includes(authorId)) {
       returnMsg = 'å–æ¶ˆå…³æ³¨æˆåŠŸ'
       author_ids = dbCmd.pull(authorId)
     } else {
       returnMsg = 'å…³æ³¨ä½œè€…æˆåŠŸ'
       author_ids = dbCmd.addToSet(authorId)
     }
   
     // å°†å¤„ç†å®Œçš„å†…å®¹è¿›è¡Œé‡æ–°æ’å…¥
     await db.collection('user').doc(userId).update({
       author_likes_ids: author_ids
     })
   
     //è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯
     return {
       code: 0,
       data: {
         msg: returnMsg
       }
     }
   };
   
   ```

   ### å››ã€å‰ç«¯å¤„ç†ç”¨æˆ·ä¿å­˜ä¿¡æ¯

   ```js
    async _followAuthor () {
         // ç”¨æˆ·æ£€æµ‹
         await this.checkedIsLogin()
         const { msg } = await this.$http.update_follow_author({ authorId: this.articleData.author.id, userId: this.userInfo._id })
         uni.showToast({
           title: msg,
         })
         //å¤„ç†ç”¨æˆ·å­˜å‚¨ä¿¡æ¯
         let followIds = [...this.userInfo.author_likes_ids]
         if (followIds.includes(this.articleData.author.id)) {
           followIds = followIds.filter(item => item != this.articleData.author.id)
         }else {
           followIds.push(this.articleData.author.id)
         }
         this.updateUserInfo({...this.userInfo,author_likes_ids:followIds})
       }
   ```

   ### äº”ã€æ”¶è—æ–‡ç« å¤„ç†

   1. ä½¿ç”¨å…¬å…±ç»„ä»¶ SaveLikes

   ```js
     <SaveLikes size="22" class="detail-bottom-icon-box" :item="articleData"></SaveLikes>
   ```

   2. å¤„ç†æ¯æ¬¡è¯·æ±‚éƒ½è¿›è¡Œæ–‡ç« åˆ—è¡¨åŠ è½½Bug

## æ–‡ç« è¯¦æƒ…é¡µé¢-ç‚¹èµ+æµè§ˆæ¬¡æ•°å®ç°



### ä¸€ã€æµè§ˆæ¬¡æ•°æ“ä½œ

> è¯·æ±‚æ–‡ç« è¯¦æƒ…çš„äº‘å‡½æ•°è¿”å›å‰ç«¯ä¹‹å‰è¿›è¡Œ+1æ“ä½œ

â€‹		

```js
  // æ¯æ¬¡è¯·æ±‚è¿›è¡Œ+1æ“ä½œ
  await db.collection('article').update({
	  browse_count:dbCmd.inc(1)
  })
```

### äºŒã€æ–‡ç« ç‚¹èµUIå¤„ç†

> â€‹	ä½¿ç”¨è®¡ç®—å±æ€§è¿›è¡ŒUiæ˜¾ç¤º

```js
  isCompliments () {
      try {
        return this.userInfo && this.userInfo.thumbs_up_article_ids.includes(this.articleData._id)
      } catch (e) {
        return false
      }
    }

```

### ä¸‰ã€äº‘å‡½æ•°å®šä¹‰

```js
'use strict';
const db = uniCloud.database()
const dbCmd = db.command  // ä½¿ç”¨æ“ä½œç¬¦
exports.main = async (event, context) => {
  const { articleId, userId } = event;

  const userList = await db.collection('user').doc(userId).get();
  const thumbs_up_article_ids = userList.data[0].thumbs_up_article_ids
  let tempArr = null;
  let returnMsg = '';
  let thumbsNumber = null;


  //todo åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦æœ‰ç‚¹èµæ“ä½œ
  if (thumbs_up_article_ids.includes(articleId)) {
    tempArr = dbCmd.pull(articleId)
    thumbsNumber = -1
    returnMsg = 'æ‚¨å–æ¶ˆäº†ç‚¹èµ'
  } else {
    tempArr = dbCmd.addToSet(articleId)
    thumbsNumber = 1
    returnMsg = 'ç‚¹èµæˆåŠŸ'
  }

  // å¤„ç†ç”¨æˆ·å­—æ®µ
  await await db.collection('user').doc(userId).update({
    thumbs_up_article_ids: tempArr
  })

  // å¤„ç†æ–‡ç« æ•°é‡å­—æ®µ
  await await db.collection('article').doc(articleId).update({
    thumbs_up_count: dbCmd.inc(thumbsNumber)
  })


  //è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯
  return {
    code: 0,
    data: {
      msg: returnMsg
    }
  }
};

```

### å››ã€å‰ç«¯å¤„ç†ç”¨æˆ·ä¿å­˜ä¿¡æ¯

```js
 // ç”¨æˆ·æ£€æµ‹
      await this.checkedIsLogin()
      
      const { msg } = await this.$http.update_compliments({ articleId: this.articleData._id, userId: this.userInfo._id })
      msg && uni.showToast({
        title: msg,
      })
      // ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯
      let thumbsArr = [...this.userInfo.thumbs_up_article_ids]
      if (thumbsArr.includes(this.articleData._id)) {
        this.articleData.thumbs_up_count -= 1
        thumbsArr = thumbsArr.filter(item => item != this.articleData._id)
      } else {
        this.articleData.thumbs_up_count += 1
        thumbsArr.push(this.articleData._id)
      }
      this.updateUserInfo({ ...this.userInfo, thumbs_up_article_ids: thumbsArr })
```

è¯„è®ºé¡µé¢åˆ¶ä½œ



### ä¸€ã€é¡µé¢æ³¨å†Œ

1. åˆ›å»ºé¡µé¢
2. page.jsonä¸­è¿›è¡Œé¡µé¢æ³¨å†Œ		
3. è·³è½¬é¡µé¢æ—¶æºå¸¦æŒ‡å®šçš„æ–‡ç« ID

### äºŒã€ç»“æ„æ ·å¼ç¼–å†™

1. ä½¿ç”¨è¯„è®ºç»„ä»¶

   ```js
    <view class="comment-content-container" v-for="item in commentList" :key="item.comment_id">
         <CommentBox @commnetReply="commnetReply" :commentData="item"></CommentBox>
       </view>
   ```

   2. ä½¿ç”¨uni-load-moreç»„ä»¶ï¼Œå¯¹ç»„ä»¶å†…éƒ¨åˆå§‹åŒ–å±æ€§è¿›è¡Œè°ƒæ•´æ“ä½œ

      ```js
       <uni-load-more v-if="commentList.length===0 || commentList.length > 5" :status="loading" :contentText="{	contentdown: 'ä¸Šæ‹‰æ˜¾ç¤ºæ›´å¤š',
      						contentrefresh: 'æ­£åœ¨åŠ è½½...',
      						contentnomore: 'æ²¡æœ‰æ›´å¤šè¯„è®ºäº†'}"></uni-load-more>
      ```

   3. æ ¹æ®æ¡ä»¶è¿›è¡Œè¯„è®ºåˆ—è¡¨çš„è¿½åŠ æ“ä½œ

      ```js
       async _getCommentList () {
            const list = await this.$http.get_comments({
              articleId: this.articleId,
              page: this.page,
              pageSize: this.pageSize,
            })
            if (list.length === 0) {
              this.loading = 'noMore'
              return
            }
            let oldList = JSON.parse(JSON.stringify(this.commentList))
            oldList.push(...list)
            this.commentList = oldList
          },
      ```

### ä¸‰ã€æ·»åŠ è¯„è®ºå†…å®¹è¾“å…¥ç»„ä»¶

```js
 <!-- è¯„è®ºå†…å®¹è¾“å…¥ç»„ä»¶ -->
    <CommentMasker :showPopup="showPopup" @closePopupMasker="showPopup=$event" @sendCommentData="_sendCommentData">
    </CommentMasker>
```

### å››ã€å¤„ç†è¯„è®ºå‘å¸ƒä¸šåŠ¡

1. å›å¤äº‹ä»¶å‡½æ•°å¤„ç†

   ```js
     /* å¤„ç†å›å¤äº‹ä»¶å‡½æ•° */
       commnetReply (data) {
         this.replyData = {
           "comment_id": data.comment.comment_id,
           is_reply: data.isReply
         }
         // å½“å‰ä¸ºå›å¤å†…å®¹çš„æ—¶å€™æ·»åŠ å›å¤çš„ID
         data.comment.reply_id && (this.replyData.reply_id = data.comment.reply_id)
         this.openMaskerComment()
       },
   ```

2. å‰¯ä½œç”¨äº‹åŠ¡å¤„ç†

   ```js
       async _sendCommentData (content) {
         const {
           msg
         } = await this.$http.update_comment({
           userId: this.userInfo._id,
           articleId: this.articleId,
           content,
           ...this.replyData   // æ‰©å±•å½“å‰æ˜¯å¦ä¸ºå›å¤æŒ‡å®šè¯„è®ºå†…å®¹
         })
         uni.showToast({
           title: msg
         })
         // å¤„ç†å‰¯ä½œç”¨äº‹ç‰©
         this.showPopup = false;
         this.replyData = {};
         this.page = 1;
         this.commentList = [];
         this._getCommentList();
       }
   ```

## å…³æ³¨ç•Œé¢-ç»“æ„æ­å»º

### æ·»åŠ è·¯ç”±å®ˆå«

1. ä¸‰æ–¹æ’ä»¶ä½¿ç”¨

   æ–‡æ¡£åœ°å€ï¼š[https://hhyang.cn/v2/](https://hhyang.cn/v2/)

2. è¿›è¡Œå®ˆå«è§„åˆ™æ·»åŠ 

   ```js
   //å…¨å±€è·¯ç”±å‰ç½®å®ˆå«
   router.beforeEach((to, from, next) => {
     // åˆ¤æ–­å½“å‰é¡µé¢æ˜¯å¦éœ€è¦ç™»å½•å¹¶ä¸”ç°åœ¨æ˜¯æ²¡æœ‰ç™»å½•çš„çŠ¶æ€
     if (to.meta.needLogin && !store.state.userInfo) {
       next({
         name: "login",
         NAVTYPE: "push"  //è·³è½¬åˆ°æ™®é€šé¡µé¢ï¼Œæ–°å¼€ä¿ç•™å†å²è®°å½•
       })
     } else {
       next();
     }
   });
   ```

3. è°ƒæ•´è·¯ç”±æ¡è£…æ–¹å¼ä¸ºç»å¯¹è·¯å¾„

   ```js
   // listCardå¤„ç†è·¯å¾„è·³è½¬
         uni.navigateTo({url: `/pages/articleDetail/articleDetail?params=${JSON.stringify(params)}`})
   
   ```

   4. articleå†…è°ƒæ•´è·¯ç”±æ¥æ”¶æ–¹å¼

      ```js
       this.articleData = this.$Router.currentRoute.query.params
      ```

   5. å¤„ç†å°ç¨‹åºæ— æ³•å…¼å®¹é—®é¢˜

      ```js
        // #ifdef MP-WEIXIN
      		if(!this.$store.state.userInfo) {
      			uni.redirectTo({
      				url:'/pages/userInfo/login/login'
      			})
      			return 
      		}
            // #endif
      ```

### äºŒã€ç•Œé¢ç»“æ„æ ·å¼æ­å»º

â€‹			

```js
<view class="follow-container">
    <view class="follow-tab">
      <view class="follow-tab-box">
        <view class="follow-tab-item" :class="{active:currentIndex===0}">æ–‡ç« </view>
        <view class="follow-tab-item" :class="{active:currentIndex===1}">ä½œè€…</view>
      </view>
    </view>
    <!-- å†…å®¹åˆ‡æ¢åŒºåŸŸ -->
    <view class="follow-list-container">
      <swiper class="follow-list-swiper" :current="currentIndex">
        <swiper-item>
          <ListItem :isShowLoading="isShowLoading" :articleList="articleList" v-if="articleList.length"></ListItem>
          <view v-if="dataNone"  class="no-data">æš‚æ— æ”¶è—çš„æ–‡ç« </view>
        </swiper-item>
        <swiper-item>
          2
        </swiper-item>
      </swiper>
    </view>
  </view>
```

### ä¸‰ã€äº‘å‡½æ•°å®šä¹‰

```js
'use strict';
const db = uniCloud.database()
const $ = db.command.aggregate; // è·å–ä¸€ä¸ªèšåˆçš„æ“ä½œç¬¦

exports.main = async (event, context) => {
	const {
		userId
	} = event;

	let userInfo = await db.collection('user').doc(userId).get()
	let article_likes_ids = userInfo.data[0].article_likes_ids; // è·å–ç”¨æˆ·çš„æ”¶è—æ–‡ç« çš„æ•°ç»„

	const list = await db.collection('article')
		.aggregate()
		.addFields({
			// åˆ¤æ–­è¿™ä¸ªæ–‡ç« çš„æ•°ç»„æ˜¯å¦åŒ…å«æ–‡ç« çš„_id ,$_id æŒ‡çš„æ˜¯æ–‡ç« åˆ—è¡¨é‡Œé¢çš„_id,å¦‚æœåŒ…å«ï¼Œè¿”å›trueï¼Œå¦åˆ™ï¼Œè¿”å›falseï¼Œåœ¨è¿™ä¸ªé‡Œé¢æ˜¯è¿‡æ»¤æŸ¥è¯¢çš„æ¯ä¸€æ¡è®°å½•å€¼
			is_like: $.in(['$_id', article_likes_ids])
		})
		.project({
			content: 0
		})
		.match({
			is_like:true
		})
		.end();

	//è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯
	return {
		code: 0,
		msg: "è¯·æ±‚æˆåŠŸ",
		data: list.data
	}
};

```

## å…³æ³¨ç•Œé¢-ä½œè€…ç»„ä»¶åˆ¶ä½œ

### ä¸€ã€å…¨å±€äº‹ä»¶ç›‘å¬

> â€‹		å¤„ç†å…³æ³¨ç•Œé¢æ•°æ®ä¸åˆ·æ–°é—®é¢˜ï¼Œä½¿ç”¨uni.$emitäº‹ä»¶æ³¨å†Œå…¨å±€äº‹ä»¶

```js
     // saveLikeç»„ä»¶
     uni.$emit('updateArticle')

    // followPageç•Œé¢

  // todo æ²¡æœ‰è¿™ä¸ªå†å²è®°å½•æ ˆçš„æ—¶å€™ä¸ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶
    uni.$on('updateArticle',(e)=> {
      this._getFollowArticle();
    })
```

### äºŒã€ä½œè€…ç»„ä»¶ç»“æ„æ­å»º

1. å…³è”swiperæ»‘åŠ¨ç»„ä»¶
2. ç»“æ„æ ·å¼æ·»åŠ    

### ä¸‰ã€äº‘å‡½æ•°å®šä¹‰

```js
'use strict';
const db = uniCloud.database()
const $ = db.command.aggregate; // è·å–ä¸€ä¸ªèšåˆçš„æ“ä½œç¬¦

exports.main = async (event, context) => {
	const {
		userId
	} = event;

	let userInfo = await db.collection('user').doc(userId).get()
	let article_likes_ids = userInfo.data[0].article_likes_ids; // è·å–ç”¨æˆ·çš„æ”¶è—æ–‡ç« çš„æ•°ç»„

	const list = await db.collection('article')
		.aggregate()
		.addFields({
			// åˆ¤æ–­è¿™ä¸ªæ–‡ç« çš„æ•°ç»„æ˜¯å¦åŒ…å«æ–‡ç« çš„_id ,$_id æŒ‡çš„æ˜¯æ–‡ç« åˆ—è¡¨é‡Œé¢çš„_id,å¦‚æœåŒ…å«ï¼Œè¿”å›trueï¼Œå¦åˆ™ï¼Œè¿”å›falseï¼Œåœ¨è¿™ä¸ªé‡Œé¢æ˜¯è¿‡æ»¤æŸ¥è¯¢çš„æ¯ä¸€æ¡è®°å½•å€¼
			is_like: $.in(['$_id', article_likes_ids])
		})
		.project({
			content: 0
		})
		.match({
			is_like:true
		})
		.end();

	//è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯
	return {
		code: 0,
		msg: "è¯·æ±‚æˆåŠŸ",
		data: list.data
	}
};

```

### å››ã€å®¢æˆ·ç«¯æ¸²æŸ“

> â€‹	å°†è·å–åˆ°çš„å†…å®¹è¿›è¡Œæ¸²æŸ“æ“ä½œ

### äº”ã€æ•°æ®åŒæ­¥

â€‹		å®šä¹‰å…¨å±€äº‹ä»¶ï¼Œå®ç°ä¿®æ”¹å…³æ³¨ä½œè€…æ—¶è§¦å‘foll_authoräº‹ä»¶ä»æ–°è°ƒç”¨

```js
uni.$on('updateAuthor',(e)=> {
      this._getAuthorList();
    })
```

## ä¸ªäººä¸­å¿ƒ-é¡µé¢ç»“æ„æ­å»º

### ä¸€ã€æœªç™»å½•çŠ¶æ€

1. å±•ç¤ºæœªç™»å½•æç¤ºç»“æ„ï¼›
2. åœ¨æœªç™»å½•çŠ¶æ€ä¸‹å¯å®ç°ç•Œé¢è·³è½¬

### äºŒã€ç™»å½•çŠ¶æ€

1. å±•ç¤ºç”¨æˆ·ç™»å½•ä¿¡æ¯å†…å®¹
2. æ·»åŠ é€€å‡ºæŒ‰é’®ï¼Œå®šä¹‰é€€å‡ºå‡½æ•°

## ä¸ªäººä¸­å¿ƒ-æˆ‘çš„æ–‡ç« 

### ä¸€ã€è¿›è¡Œç”¨æˆ·ä¿¡æ¯æ¸²æŸ“

### äºŒã€å®Œæˆappå‡çº§ç‰ˆæœ¬é€»è¾‘å¤„ç†

1. åˆå§‹åŒ–onLoadäº‹ä»¶è¿›è¡Œç‰ˆæœ¬æ£€æµ‹

   ```js
     // !åˆ¤æ–­æ˜¯å¦æœ‰æ–°ç‰ˆæœ¬è¿›è¡Œä¸‹è½½åŠè·å–å½“å‰çš„ç‰ˆæœ¬
       // #ifdef APP-PLUS
       uni.getSystemInfo({
         success: (res) => {
           if (res.platform == "android") {
             plus.runtime.getProperty(plus.runtime.appid, wgtinfo => {
               this.currentVersion = wgitinfo;
               this._checkVersion();
             })
           }
         }
       })
       // #endif
   ```

2. è¿›è¡Œç‰ˆæœ¬æ£€æµ‹ï¼Œåˆ¤æ–­å½“å‰ç‰ˆæœ¬æ˜¯å¦å°äºæœ€æ–°ç‰ˆæœ¬

   ```js
    // appä¸­åˆ¤æ–­æ˜¯å¦æœ‰æ–°ç‰ˆæœ¬
       async _checkVersion() {
         const {version,downLoadLinkUrl} = await this.$http.get_current_version();
         if(version > this.currentVersion) {
           this.haveNewVersion = true;
           this.downLoadLinkUrl = downLoadLinkUrl
         }
       },
   ```

   

3. ä¸‹è½½æœ€æ–°ç‰ˆæœ¬å†…å®¹è¿›è¡Œå®‰è£…å¤„ç†

   ```js
    // è·å–æœ€æ–°ç‰ˆæœ¬appä¸‹è½½
       _getNewVersion() {
         uni.showLoading({title:'ä¸‹è½½ä¸­ï¼Œè¯·ç¨å'});
          var dtask = plus.downloader.createDownload(this.downLoadLinkUrl, {}, function (d, status) {
           // ä¸‹è½½å®Œæˆ  
           uni.hideLoading({})
           if (status == 200) {
             plus.runtime.install(plus.io.convertLocalFileSystemURL(d.filename), {}, {}, function (error) {
               uni.showToast({
                 title: 'å®‰è£…å¤±è´¥',
                 duration: 1500,
                 icon: 'none'
               });
             })
           } else {
             uni.showToast({
               title: 'æ›´æ–°å¤±è´¥',
               duration: 1500,
               icon: 'none'
             });
           }
         });
         dtask.start();
       }
   ```

### ä¸‰ã€æˆ‘çš„æ–‡ç« å¤„ç†

1. åˆ›å»ºé¡µé¢

2. ç»„ä»¶å¼•å…¥

3. æ•°æ®è·å–-äº‘å‡½æ•°å®šä¹‰

   ```js
   ## ä¸ªäººä¸­å¿ƒ-æ„è§åé¦ˆ
   
   ### ä¸€ã€é¡µé¢ç»“æ„æ­å»º
   
   1. ç»“æ„åˆ›å»º
   
   2. æ ·å¼å¤„ç†
   
      ```css
      .feedback-title {
          margin: 30rpx;
          margin-bottom: 0;
          font-size: 28rpx;
          color: #666;
      }
      
      .feedback-content {
          margin: 30rpx;
          padding: 20rpx;
          box-sizing: border-box;
          border: 1px solid #eee;
          .feedback-textarea {
              font-size: 24rpx;
              width: 100%;
              height: 200rpx;
          }
      }
      
      .feedback-image-box {
          display: flex;
          flex-wrap: wrap;
          padding: 20rpx;
          .feedback-image-item {
              position: relative;
              width: 33.33%;
              height: 0;
              padding-top: 33.33%;
              box-sizing: border-box;
              .close-icon {
                  @include flex(center);
                  right: 0;
                  top: 0;
                  width: 44rpx;
                  height: 44rpx;
                  position: absolute;
                  border-radius: 50%;
                  z-index: 2;
                  background-color: $base-color;
              }
              .image-box {
                  @include flex(center);
                  top: 10rpx;
                  right: 10rpx;
                  bottom: 10rpx;
                  left: 10rpx;
                  border: 1px solid #eee;
                  border-radius: 10rpx;
                  overflow: hidden;
                  position: absolute;
                  image {
                      width: 100%;
                      height: 100%;
                  }
              }
          }
      }
      
      .feedback-button {
          margin: 0 30rpx;
          background-color: $base-color;
      }
   ```
   
   ### äºŒã€æ–°å¢å›¾ç‰‡æ“ä½œ
   
   1. chooseImageå‚è€ƒåœ°å€ï¼š[https://uniapp.dcloud.io/api/media/image?id=chooseimage](https://uniapp.dcloud.io/api/media/image?id=chooseimage)
   
   2. ä¸ºå‰ç«¯UIè¿›è¡Œå›¾ç‰‡å®šä¹‰
   
      ```js
        const count = 5 - this.imageList.length;
            uni.chooseImage({
              count,
              success: res => {
                const tempFilePaths = res.tempFilePaths;
                tempFilePaths.forEach((url, index) => {
                  if (index < count) {
                    this.imageList.push({
                      url,
                      name: res.tempFiles[index].name
                    })
                  }
                })
              }
            })
      ```
   
      
   
   ### ä¸‰ã€å‘é€æ•°æ®åˆ°äº‘å‡½æ•°
   
   1. å›¾ç‰‡ç›´ä¼ å‚è€ƒåœ°å€ï¼š[https://uniapp.dcloud.io/uniCloud/storage?id=clouduploadfile](https://uniapp.dcloud.io/uniCloud/storage?id=clouduploadfile)
   
   2. æ”¶é›†å›¾ç‰‡ä¸Šä¼ æˆåŠŸä¹‹åçš„è®¿é—®åœ°å€
   
      ```js
       return this.imageList.map(item => {
              return new Promise(async resolve => {
                const result = await uniCloud.uploadFile({
                  filePath: item.url,
                  cloudPath: item.name
                })
                resolve(result.fileID)
              })
            })
      ```
   
   3. å®šä¹‰äº‘å‡½æ•°
   
      ```js
      'use strict';
      const db = uniCloud.database();
      exports.main = async (event, context) => {
      	const {
      		userId,
      		feedbackImageList,
      		content
      	} = event
      	
      	await db.collection('feedback').add({
      		user_id:userId,
      		feedbackImageList,
      		content
      	})
      	return {
      		code:0,
      		data:{
      			msg:"æäº¤åé¦ˆæˆåŠŸ"
      		}
      	}
      };
      ```
   
   ### å››ã€ç”¨æˆ·å¤´åƒä¿®æ”¹
   
   > â€‹		è·å–ä¿®æ”¹å¤´åƒå†…å®¹ï¼Œä¸Šä¼ äº‘å‡½æ•° ï¼Œè¿›è¡Œå›¾ç‰‡çš„ä¿®æ”¹ï¼ŒåŠåŸå›¾ç‰‡çš„åˆ é™¤æ“ä½œ
   
   ```js
   'use strict';
   const db = uniCloud.database();
   exports.main = async (event, context) => {
   	const {
   		userId,
   		filePath
   	} = event;
   	
   	const user = await db.collection('user').doc(userId).get()
   	const oldImgList = user.data[0].avatar
   	try {
   		await uniCloud.deleteFile({
   			fileList: [oldImgList],
   		});
   	}catch(e) {
   		console.log(e)
   	}
   	 
   	 await db.collection('user').doc(userId).update({
   		avatar:filePath
   	})
   	
   	//è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯
   	return {
   		code: 0,
   		data: {
   			msg:"ä¿®æ”¹å¤´åƒæˆåŠŸ",
   		}
   	}
   };
   
   ```
   
   â€‹			
   
   'use strict';
   const db = uniCloud.database()
   const dbCmd = db.command;
   
   exports.main = async (event, context) => {
   	const {
   		userId
   	} = event;
   
   	let userInfo = await db.collection('user').doc(userId).get()
   	let article_ids = userInfo.data[0].article_ids; 
   	
   	const list = await db.collection('article')
   		.aggregate()
   		.project({
   			content: 0,
   			comments:0
   		})
   		.match({
   			id:dbCmd.in(article_ids)
   		})
   		.end();
   	
   	//è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯
   	return {
   		code: 0,
   		msg: "è¯·æ±‚æˆåŠŸ",
   		data: list.data
   	}
   };
   
   ```
   
   ```

## å‘å¸ƒ-wapç«¯å‘è¡Œæ‰“åŒ…

> æ‰“åŒ…å‚è€ƒåœ°å€ï¼š[https://uniapp.dcloud.io/collocation/manifest?id=h5](https://uniapp.dcloud.io/collocation/manifest?id=h5)

![image-20230213120022226](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131200409.png)

#### unicloudç½‘é¡µæ‰˜ç®¡é…ç½®

> ä½¿ç”¨unicloudå‰ç«¯ç½‘é¡µæ‰˜ç®¡çš„è¯éœ€è¦è¿›è¡Œå®‰å…¨åŸŸåé…ç½®

å‚è€ƒåœ°å€ï¼š[https://uniapp.dcloud.io/uniCloud/hosting](https://uniapp.dcloud.io/uniCloud/hosting)

## å‘å¸ƒ-å¾®ä¿¡å°ç¨‹åºå‘å¸ƒ

> æ‰“åŒ…å‚è€ƒåœ°å€ï¼š[https://uniapp.dcloud.io/collocation/manifest?id=h5](https://uniapp.dcloud.io/collocation/manifest?id=h5)

1. æ‰“åŒ…é…ç½®æ–‡ä»¶

   - è·å–å°ç¨‹åºIDï¼›

   - è¿›è¡Œå®‰å…¨åŸŸåé…ç½®

     ![image-20230213133221370](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131332504.png)

2. å°ç¨‹åºå‘å¸ƒ

3. æäº¤é¢„å‘å¸ƒç‰ˆæœ¬

4. æäº¤å®¡æ ¸

   å‚è€ƒåœ°å€ï¼šhttps://mp.weixin.qq.com/wxamp/wacodepage/getcodepage?token=1374043880&lang=zh_CN

## å‘å¸ƒ-appå®‰å“ç³»ç»Ÿåº”ç”¨æ‰“åŒ…å‘å¸ƒ

### ä¸€ã€é…ç½®

1. åŸºç¡€é…ç½®

   ![image-20230213133412430](https://duyi-bucket.oss-cn-beijing.aliyuncs.com/uni/202302131334590.png)

2. å›¾æ ‡ä½¿ç”¨

   > ä½¿ç”¨1024*1024å›¾æ ‡

3. å…¶ä»–é…ç½®æš‚æ—¶å¿½ç•¥

### äºŒã€è¯ä¹¦ä¸‹è½½

> è¯ä¹¦ä¸‹è½½åœ°å€ï¼š[https://www.taomamao.cn/index.php/apkcert](https://www.taomamao.cn/index.php/apkcert)
